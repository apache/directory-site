<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>4-2 - ASN/1 LDAP grammar &mdash; Apache Directory</title>

    <link href="/css/common.css" rel="stylesheet" type="text/css"/>
    <link href="/css/brown.css" rel="stylesheet" type="text/css"/>

    <link rel="shortcut icon" href="/images/server-icon_16x16.png" />
    <script src="https://www.apachecon.com/event-images/snippet.js"></script>
</head>

<body>
<div id="container">
    <div id="header">
    <div id="subProjectsNavBar">
        <a href="/">
             
                Main
            
        </a>
        &nbsp;|&nbsp;
        <a href="/apacheds/">
             
                ApacheDS
            
        </a>
        &nbsp;|&nbsp;
        <a href="/studio/">
             
                Studio
            
        </a>
        &nbsp;|&nbsp;
        <a href="/api/">
            
                <strong>LDAP API</strong>
            
        </a>
        &nbsp;|&nbsp;
        <a href="/mavibot/">
             
                Mavibot
            
        </a>
        &nbsp;|&nbsp;
        <a href="/scimple/">
             
                SCIMple
            
        </a>
        &nbsp;|&nbsp;
        <a href="/fortress/">
             
                Fortress
            
        </a>
        &nbsp;|&nbsp;
        <a href="/kerby/">
             
                Kerby
            
        </a>
    </div>
</div>


    <div id="content">
        <div id="leftColumn">
            <div id="navigation">
                
                <a class="acevent" data-format="wide" data-width="170"></a>
                <h5>LDAP API </h5>
                <ul>
                    <li><a href="/api/">Home</a></li>
                    <li><a href="/api/news.html">News</a></li>
                </ul>

                <h5>Downloads</h5>
                <ul>
                    <li><a href="/api/downloads-2.html">Version 2.1.7</a>&nbsp;&nbsp;<img src="/images/new_badge.gif" alt="" style="margin-bottom:-3px;" border="0"></li>
                    <li><a href="/api/downloads-1.html">Version 1.0.3</a>&nbsp;&nbsp;</li>
                    <li><a href="/api/download-old-versions.html">Older versions</a></li>
                </ul>

                <h5>Getting Started</h5>
                <ul>
                    <li><a href="/api/vision.html">Vision</a></li>
                    <li><a href="/api/java-api.html">Java API</a></li>
                </ul>

                <h5>Documentation</h5>
                <ul>
                    <li><a href="/api/five-minutes-tutorial.html">Five minute tutorial</a></li>
                    <li><a href="/api/user-guide.html">User Guide</a></li>
                    <li><a href="/api/migration-guide.html">API 1 to 2 migration</a></li>
                    <li><a href="/api/gen-docs/latest2/apidocs/">JavaDocs 2</a></li>
                    <li><a href="/api/gen-docs/latest/apidocs/">JavaDocs</a></li>
                    <li><a href="/api/gen-docs/latest2/xref/">Cross-Reference 2</a></li>
                    <li><a href="/api/gen-docs/latest/xref/">Cross-Reference</a></li>
                    
                    <li><a href="/api/developer-guide.html">Developer Guide</a></li>
                    <li><a href="/api/internal-design-guide.html">Internal Guide</a></li>
                </ul>

                <h5>Support</h5>
<ul>
    <li><a href="/mailing-lists-and-irc.html">Mailing Lists &amp; IRC</a></li>
    <li><a href="/sources.html">Sources</a></li>
    <li><a href="/issue-tracking.html">Issue Tracking</a></li>
    <li><a href="/commercial-support.html">Commercial Support</a></li>
</ul>

<h5>Community</h5>
<ul>
    <li><a href="/contribute.html">How to Contribute</a></li>
    <li><a href="/team.html">Team</a></li>
    <li><a href="/original-project-proposal.html">Original Project Proposal</a></li>
    <li><a href="/special-thanks.html" class="external-link" rel="nofollow">Special Thanks</a></li>
</ul>

<h5>About Apache</h5>
<ul>
    <li><a href="https://www.apache.org/">Apache</a></li>
    <li><a href="https://www.apache.org/licenses/">License</a></li>
    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
    <li><a href="https://www.apache.org/security/">Security</a></li>
</ul>

            </div>
        </div>
        <div id="rightColumn">
            
    <div class="nav">
        <div class="nav_prev">
            
                
                <a href="4.1-asn1-tlv.html">4-1 - ASN/1 TLV</a>
            
        </div>
        <div class="nav_up">
            
                
                <a href="../internal-design-guide.html">Internal Design Guide</a>
            
        </div>
        <div class="nav_next">
            
                
                <a href="5-network.html">5 - Network</a>
            
        </div>
        <div class="clearfix"></div>
    </div>


            
	<h2 id="table-of-content">Table of content</h2>
<ul>
<li><a href="#asn1-ldap-grammar">4.2 - ASN/1 LDAP Grammar</a>
<ul>
<li><a href="#ldapmessage">LDAPMessage</a></li>
<li><a href="#ldapresult">LDAPResult</a></li>
<li><a href="#controls">Controls</a></li>
<li><a href="#abandonrequest-operation">AbandonRequest</a></li>
<li><a href="#addrequest-operation">AddRequest</a></li>
<li><a href="#addresponse-operation">AddResponse</a></li>
<li><a href="#bindrequest-operation">BindRequest</a></li>
<li><a href="#bindresponse-operation">BindResponse</a></li>
<li><a href="#comparerequest-operation">CompareRequest</a></li>
<li><a href="#compareresponse-operation">CompareResponse</a></li>
<li><a href="#delrequest-operation">DelRequest</a></li>
<li><a href="#delresponse-operation">DelResponse</a></li>
<li><a href="#extendedrequest-operation">ExtendedRequest</a></li>
<li><a href="#extendedresponse-operation">ExtendedResponse</a></li>
<li><a href="#intermediateresponse-operation">IntermediateResponse</a></li>
<li><a href="#modifyrequest-operation">ModifyRequest</a></li>
<li><a href="#modifyresponse-operation">ModifyResponse</a></li>
<li><a href="#modifydnequest-operation">ModifyDNRequest</a></li>
<li><a href="#modifydnresponse-operation">ModifyDNResponse</a></li>
<li><a href="#searchrequest-operation">SearchRequest</a></li>
<li><a href="#searchresultdone-operation">SearchResultDone</a></li>
<li><a href="#searchresultentry-operation">SearchResultEntry</a></li>
<li><a href="#searchresultreference-operation">SearchResultReference</a></li>
<li><a href="#unbindrequest-operation">UnbindRequest</a></li>
</ul>
</li>
</ul>
<h1 id="asn1-ldap-grammar">ASN/1 LDAP grammar</h1>
<p>The <strong>LDAP</strong> grammar is defined in <a href="https://www.rfc-editor.org/rfc/rfc4511#appendix-B">RFC 4511, appendix B</a>.</p>
<p>Here it is:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Text" data-lang="Text">Lightweight-Directory-Access-Protocol-V3 {1 3 6 1 1 18}
        -- Copyright (C) The Internet Society (2006).  This version of
        -- this ASN.1 module is part of RFC 4511; see the RFC itself
        -- for full legal notices.
        DEFINITIONS
        IMPLICIT TAGS
        EXTENSIBILITY IMPLIED ::=

        BEGIN

        LDAPMessage ::= SEQUENCE {
             messageID       MessageID,
             protocolOp      CHOICE {
                  bindRequest           BindRequest,
                  bindResponse          BindResponse,
                  unbindRequest         UnbindRequest,
                  searchRequest         SearchRequest,
                  searchResEntry        SearchResultEntry,
                  searchResDone         SearchResultDone,
                  searchResRef          SearchResultReference,
                  modifyRequest         ModifyRequest,
                  modifyResponse        ModifyResponse,
                  addRequest            AddRequest,
                  addResponse           AddResponse,
                  delRequest            DelRequest,
                  delResponse           DelResponse,
                  modDNRequest          ModifyDNRequest,
                  modDNResponse         ModifyDNResponse,
                  compareRequest        CompareRequest,
                  compareResponse       CompareResponse,
                  abandonRequest        AbandonRequest,
                  extendedReq           ExtendedRequest,
                  extendedResp          ExtendedResponse,
                  ...,
                  intermediateResponse  IntermediateResponse },
             controls       [0] Controls OPTIONAL }

        MessageID ::= INTEGER (0 ..  maxInt)

        maxInt INTEGER ::= 2147483647 -- (2^^31 - 1) --

        LDAPString ::= OCTET STRING -- UTF-8 encoded,
                                    -- [ISO10646] characters

        LDAPOID ::= OCTET STRING -- Constrained to &lt;numericoid&gt;
                                 -- [RFC4512]

        LDAPDN ::= LDAPString -- Constrained to &lt;distinguishedName&gt;
                              -- [RFC4514]

        RelativeLDAPDN ::= LDAPString -- Constrained to &lt;name-component&gt;
                                      -- [RFC4514]

        AttributeDescription ::= LDAPString
                                -- Constrained to &lt;attributedescription&gt;
                                -- [RFC4512]

        AttributeValue ::= OCTET STRING

        AttributeValueAssertion ::= SEQUENCE {
             attributeDesc   AttributeDescription,
             assertionValue  AssertionValue }

        AssertionValue ::= OCTET STRING

        PartialAttribute ::= SEQUENCE {
             type       AttributeDescription,
             vals       SET OF value AttributeValue }

        Attribute ::= PartialAttribute(WITH COMPONENTS {
             ...,
             vals (SIZE(1..MAX))})

        MatchingRuleId ::= LDAPString

        LDAPResult ::= SEQUENCE {
             resultCode         ENUMERATED {
                  success                      (0),
                  operationsError              (1),
                  protocolError                (2),
                  timeLimitExceeded            (3),
                  sizeLimitExceeded            (4),
                  compareFalse                 (5),
                  compareTrue                  (6),
                  authMethodNotSupported       (7),
                  strongerAuthRequired         (8),
                       -- 9 reserved --
                  referral                     (10),
                  adminLimitExceeded           (11),
                  unavailableCriticalExtension (12),
                  confidentialityRequired      (13),
                  saslBindInProgress           (14),
                  noSuchAttribute              (16),
                  undefinedAttributeType       (17),
                  inappropriateMatching        (18),
                  constraintViolation          (19),
                  attributeOrValueExists       (20),
                  invalidAttributeSyntax       (21),
                       -- 22-31 unused --
                  noSuchObject                 (32),
                  aliasProblem                 (33),
                  invalidDNSyntax              (34),
                       -- 35 reserved for undefined isLeaf --
                  aliasDereferencingProblem    (36),
                       -- 37-47 unused --
                  inappropriateAuthentication  (48),
                  invalidCredentials           (49),
                  insufficientAccessRights     (50),
                  busy                         (51),
                  unavailable                  (52),
                  unwillingToPerform           (53),
                  loopDetect                   (54),
                       -- 55-63 unused --
                  namingViolation              (64),
                  objectClassViolation         (65),
                  notAllowedOnNonLeaf          (66),
                  notAllowedOnRDN              (67),
                  entryAlreadyExists           (68),
                  objectClassModsProhibited    (69),
                       -- 70 reserved for CLDAP --
                  affectsMultipleDSAs          (71),
                       -- 72-79 unused --
                  other                        (80),
                  ...  },
             matchedDN          LDAPDN,
             diagnosticMessage  LDAPString,
             referral           [3] Referral OPTIONAL }

        Referral ::= SEQUENCE SIZE (1..MAX) OF uri URI

        URI ::= LDAPString     -- limited to characters permitted in
                               -- URIs

        Controls ::= SEQUENCE OF control Control

        Control ::= SEQUENCE {
             controlType             LDAPOID,
             criticality             BOOLEAN DEFAULT FALSE,
             controlValue            OCTET STRING OPTIONAL }

        BindRequest ::= [APPLICATION 0] SEQUENCE {
             version                 INTEGER (1 ..  127),
             name                    LDAPDN,
             authentication          AuthenticationChoice }

        AuthenticationChoice ::= CHOICE {
             simple                  [0] OCTET STRING,
                                     -- 1 and 2 reserved
             sasl                    [3] SaslCredentials,
             ...  }

        SaslCredentials ::= SEQUENCE {
             mechanism               LDAPString,
             credentials             OCTET STRING OPTIONAL }

        BindResponse ::= [APPLICATION 1] SEQUENCE {
             COMPONENTS OF LDAPResult,
             serverSaslCreds    [7] OCTET STRING OPTIONAL }

        UnbindRequest ::= [APPLICATION 2] NULL

        SearchRequest ::= [APPLICATION 3] SEQUENCE {
             baseObject      LDAPDN,
             scope           ENUMERATED {
                  baseObject              (0),
                  singleLevel             (1),
                  wholeSubtree            (2),
                  ...  },
             derefAliases    ENUMERATED {
                  neverDerefAliases       (0),
                  derefInSearching        (1),
                  derefFindingBaseObj     (2),
                  derefAlways             (3) },
             sizeLimit       INTEGER (0 ..  maxInt),
             timeLimit       INTEGER (0 ..  maxInt),
             typesOnly       BOOLEAN,
             filter          Filter,
             attributes      AttributeSelection }

        AttributeSelection ::= SEQUENCE OF selector LDAPString
                       -- The LDAPString is constrained to
                       -- &lt;attributeSelector&gt; in Section 4.5.1.8

        Filter ::= CHOICE {
             and             [0] SET SIZE (1..MAX) OF filter Filter,
             or              [1] SET SIZE (1..MAX) OF filter Filter,
             not             [2] Filter,
             equalityMatch   [3] AttributeValueAssertion,
             substrings      [4] SubstringFilter,
             greaterOrEqual  [5] AttributeValueAssertion,
             lessOrEqual     [6] AttributeValueAssertion,
             present         [7] AttributeDescription,
             approxMatch     [8] AttributeValueAssertion,
             extensibleMatch [9] MatchingRuleAssertion,
             ...  }

        SubstringFilter ::= SEQUENCE {
             type           AttributeDescription,
             substrings     SEQUENCE SIZE (1..MAX) OF substring CHOICE {
                  initial [0] AssertionValue,  -- can occur at most once
                  any     [1] AssertionValue,
                  final   [2] AssertionValue } -- can occur at most once
             }

        MatchingRuleAssertion ::= SEQUENCE {
             matchingRule    [1] MatchingRuleId OPTIONAL,
             type            [2] AttributeDescription OPTIONAL,
             matchValue      [3] AssertionValue,
             dnAttributes    [4] BOOLEAN DEFAULT FALSE }

        SearchResultEntry ::= [APPLICATION 4] SEQUENCE {
             objectName      LDAPDN,
             attributes      PartialAttributeList }

        PartialAttributeList ::= SEQUENCE OF
                             partialAttribute PartialAttribute

        SearchResultReference ::= [APPLICATION 19] SEQUENCE
                                  SIZE (1..MAX) OF uri URI

        SearchResultDone ::= [APPLICATION 5] LDAPResult

        ModifyRequest ::= [APPLICATION 6] SEQUENCE {
             object          LDAPDN,
             changes         SEQUENCE OF change SEQUENCE {
                  operation       ENUMERATED {
                       add         (0),
                       delete      (1),
                       replace     (2),
                       increment   (3), // RFC 4525 addition
                       ...  },
                  modification    PartialAttribute } }

        ModifyResponse ::= [APPLICATION 7] LDAPResult

        AddRequest ::= [APPLICATION 8] SEQUENCE {
             entry           LDAPDN,
             attributes      AttributeList }

        AttributeList ::= SEQUENCE OF attribute Attribute

        AddResponse ::= [APPLICATION 9] LDAPResult

        DelRequest ::= [APPLICATION 10] LDAPDN

        DelResponse ::= [APPLICATION 11] LDAPResult

        ModifyDNRequest ::= [APPLICATION 12] SEQUENCE {
             entry           LDAPDN,
             newrdn          RelativeLDAPDN,
             deleteoldrdn    BOOLEAN,
             newSuperior     [0] LDAPDN OPTIONAL }

        ModifyDNResponse ::= [APPLICATION 13] LDAPResult

        CompareRequest ::= [APPLICATION 14] SEQUENCE {
             entry           LDAPDN,
             ava             AttributeValueAssertion }

        CompareResponse ::= [APPLICATION 15] LDAPResult

        AbandonRequest ::= [APPLICATION 16] MessageID

        ExtendedRequest ::= [APPLICATION 23] SEQUENCE {
             requestName      [0] LDAPOID,
             requestValue     [1] OCTET STRING OPTIONAL }

        ExtendedResponse ::= [APPLICATION 24] SEQUENCE {
             COMPONENTS OF LDAPResult,
             responseName     [10] LDAPOID OPTIONAL,
             responseValue    [11] OCTET STRING OPTIONAL }

        IntermediateResponse ::= [APPLICATION 25] SEQUENCE {
             responseName     [0] LDAPOID OPTIONAL,
             responseValue    [1] OCTET STRING OPTIONAL }

        END
</code></pre></div><h2 id="ldapmessage">LdapMessage</h2>
<p>The <strong>LDAPMessage</strong> grammar starts with this part:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">        LDAPMessage ::= SEQUENCE {
             messageID       INTEGER (0 .. maxInt),
             protocolOp      CHOICE {
                  bindRequest           BindRequest,
                  bindResponse          BindResponse,
                  unbindRequest         UnbindRequest,
                  searchRequest         SearchRequest,
                  searchResEntry        SearchResultEntry,
                  searchResDone         SearchResultDone,
                  searchResRef          SearchResultReference,
                  modifyRequest         ModifyRequest,
                  modifyResponse        ModifyResponse,
                  addRequest            AddRequest,
                  addResponse           AddResponse,
                  delRequest            DelRequest,
                  delResponse           DelResponse,
                  modDNRequest          ModifyDNRequest,
                  modDNResponse         ModifyDNResponse,
                  compareRequest        CompareRequest,
                  compareResponse       CompareResponse,
                  abandonRequest        AbandonRequest,
                  extendedReq           ExtendedRequest,
                  extendedResp          ExtendedResponse,
                  ...,
                  intermediateResponse  IntermediateResponse },
             controls       [0] Controls OPTIONAL }
</code></pre></div><p>We have three parts:</p>
<ul>
<li>The message <em>ID</em></li>
<li>The protocol part</li>
<li>The optional controls</li>
</ul>
<p>The following picture gives a clear view of the existing transitions:</p>
<img src="images/asn1-ldap-message.png" alt="LDAP message state machine" width="100%"/>
<p>The green boxes are sub-transitions, which will be descibed below.
The red arrow indicates which transition are mandatory.
Each transition is based on the tag used between two states.
Dashed arrows are optional transitions.</p>
<p>There are 15 mandatory transitions:</p>
<ul>
<li><em>ADD_REQUEST_STATE</em></li>
<li><em>ADD_RESPONSE_STATE</em></li>
<li><em>BIND_REQUEST_STATE</em></li>
<li><em>BIND_RESPONSE_STATE</em></li>
<li><em>COMPARE_REQUEST_STATE</em></li>
<li><em>COMPARE_RESPONSE_STATE</em></li>
<li><em>DEL_RESPONSE_STATE</em></li>
<li><em>EXTENDED_RESPONSE_STATE</em></li>
<li><em>MODIFY_DN_REQUEST_STATE</em></li>
<li><em>MODIFY_DN_RESPONSE_STATE</em></li>
<li><em>MODIFY_REQUEST_STATE</em></li>
<li><em>MODIFY_RESPONSE_STATE</em></li>
<li><em>SEARCH_REQUEST_STATE</em></li>
<li><em>SEARCH_RESULT_DONE_STATE</em></li>
<li><em>SEARCH_RESULT_ENTRY_STATE</em></li>
</ul>
<p>Here is a flat representation of a <strong>LDAP</strong> message structure, where we see the encapsulated <strong>TLVs</strong>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">+---+---+-----------------------------------------------------------------------------------------------------------------+
|   |   | +---+---+------------+ +---+---+--------------------+ [+---+---+---------------------------------------------+] |
|   |   | |   |   |            | |   |   |                    | [|   |   | +---+---+---------+     +---+---+---------+ |] |
| T | L | | T | L | message ID | | T | L | protocol operation | [| T | L | | T | L | control | ... | T | L | control | |] |
|   |   | |   |   |            | |   |   |                    | [|   |   | +-o-+-o-+----o----+     +---+---+---------+ |] |
|   |   | +-o-+-o-+-----o------+ +-o-+-o-+---------o----------+ [+-o-+-o-+---|---|------|------------------------------+] |
+-o-+-o-+---|---|-------|----------|---|-----------|---------------|---|-----|---|------|---------------------------------+
  |   |     |   |       |          |   |           |               |   |     |   |      |
  |   |     |   |       |          |   |           |               |   |     |   |      +----------&gt; A control&#39;s encoded value
  |   |     |   |       |          |   |           |               |   |     |   |       
  |   |     |   |       |          |   |           |               |   |     |   +-----------------&gt; A control&#39;s length
  |   |     |   |       |          |   |           |               |   |     |   
  |   |     |   |       |          |   |           |               |   |     +---------------------&gt; A control&#39;s sequence (0x30)   
  |   |     |   |       |          |   |           |               |   |     
  |   |     |   |       |          |   |           |               |   +---------------------------&gt; The controls total length
  |   |     |   |       |          |   |           |               |
  |   |     |   |       |          |   |           |               +-------------------------------&gt; The controls sequence tag (0xA0)
  |   |     |   |       |          |   |           |
  |   |     |   |       |          |   |           +-----------------------------------------------&gt; The encoded operation
  |   |     |   |       |          |   |
  |   |     |   |       |          |   +-----------------------------------------------------------&gt; The operation length
  |   |     |   |       |          |
  |   |     |   |       |          +---------------------------------------------------------------&gt; The operation code (can be 0x60 for a BindRequest)
  |   |     |   |       |
  |   |     |   |       +--------------------------------------------------------------------------&gt; The message ID
  |   |     |   |
  |   |     |   +----------------------------------------------------------------------------------&gt; The message ID&#39;s length (from 1 to 4)
  |   |     |
  |   |     +--------------------------------------------------------------------------------------&gt; The message ID&#39;s tag, 0x02 for an INTEGER
  |   |
  |   +--------------------------------------------------------------------------------------------&gt; The LDAP message&#39;s length
  |
  +------------------------------------------------------------------------------------------------&gt; The LDAP message sequence (0x30)
</code></pre></div><p>Now, here is the sub-message <strong>protocolOp</strong>:</p>
<img src="images/asn1-protocol-op.png" alt="protocol operations state machine" width="100%"/>
<p>It covers all the existing <strong>LDAP</strong> messages.</p>
<h2 id="ldapresult">LdapResult</h2>
<p>The <strong>LDAPResult</strong> element is part of all the <strong>LDAP</strong> response. It contains the following informations:</p>
<ul>
<li>A result code, indicating either a success (code 0) or an error (code from 1 to 80, but it may be higher in a future version)</li>
<li>A <strong>DN</strong> representing the associated entry</li>
<li>A diagnostic message in case of an error</li>
<li>An optional list of <strong>LDAP URL</strong> that may be able to process the operation.</li>
</ul>
<p>Here is the complete grammar, as defined in <a href="https://www.rfc-editor.org/rfc/rfc4511">RFC4511</a>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">LDAPResult ::= SEQUENCE {
             resultCode         ENUMERATED {
                  success                      (0),
                  operationsError              (1),
                  protocolError                (2),
                  timeLimitExceeded            (3),
                  sizeLimitExceeded            (4),
                  compareFalse                 (5),
                  compareTrue                  (6),
                  authMethodNotSupported       (7),
                  strongerAuthRequired         (8),
                  referral                     (10),
                  adminLimitExceeded           (11),
                  unavailableCriticalExtension (12),
                  confidentialityRequired      (13),
                  saslBindInProgress           (14),
                  noSuchAttribute              (16),
                  undefinedAttributeType       (17),
                  inappropriateMatching        (18),
                  constraintViolation          (19),
                  attributeOrValueExists       (20),
                  invalidAttributeSyntax       (21),
                  noSuchObject                 (32),
                  aliasProblem                 (33),
                  invalidDNSyntax              (34),
                  aliasDereferencingProblem    (36),
                  inappropriateAuthentication  (48),
                  invalidCredentials           (49),
                  insufficientAccessRights     (50),
                  busy                         (51),
                  unavailable                  (52),
                  unwillingToPerform           (53),
                  loopDetect                   (54),
                  namingViolation              (64),
                  objectClassViolation         (65),
                  notAllowedOnNonLeaf          (66),
                  notAllowedOnRDN              (67),
                  entryAlreadyExists           (68),
                  objectClassModsProhibited    (69),
                  affectsMultipleDSAs          (71),
                  other                        (80),
                  ...  },
             matchedDN          OCTET STRING,
             diagnosticMessage  OCTET STRING,
             referral           [3] Referral OPTIONAL }

        Referral ::= SEQUENCE SIZE (1..MAX) OF uri OCTET STRING

        URI ::= LDAPString     -- limited to characters permitted in
                               -- URIs

</code></pre></div><p>The associated state machine is given by this schema:</p>
<img src="images/asn1-ldap-result.png" alt="LDAPResult state machine" width="100%"/>
<h2 id="controls">Controls</h2>
<p>The <strong>Control</strong> grammar is the following:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">     Controls ::= SEQUENCE OF control Control

     Control ::= SEQUENCE {
             controlType             OCTET STRING,
             criticality             BOOLEAN DEFAULT FALSE,
             controlValue            OCTET STRING OPTIONAL 
</code></pre></div><p>The associated state machine is given by this schema:</p>
<img src="images/asn1-controls.png" alt="Controls state machine" width="100%"/>
<p>There is no mandatory transition.</p>
<h2 id="abandonrequest-operation">AbandonRequest operation</h2>
<p>The <strong>AbandonRequest</strong> message grammar is the following:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">AbandonRequest ::= [APPLICATION 16] INTEGER (0 .. maxInt)
</code></pre></div><p>The state machine for this operation is already described in the <a href="#ldapmessage">LdapMessage</a> state machine. The operation code (0x50) is completed with the <em>ID</em> of the message to be abandonned.</p>
<h2 id="addrequest-operation">AddRequest operation</h2>
<p>The <strong>AddRequest</strong> message grammar is the following:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">AddRequest ::= [APPLICATION 8] SEQUENCE {
             entry           OCTET STRING,
             attributes      AttributeList }

AttributeList ::= SEQUENCE OF attribute Attribute

Attribute ::= PartialAttribute(WITH COMPONENTS {
             ...,
             vals (SIZE(1..MAX))})

PartialAttribute ::= SEQUENCE {
             type       OCTET STRING,
             vals       SET OF value OCTET STRING }
</code></pre></div><p>Its state machine is shown in this picture:</p>
<img src="images/asn1-add-request.png" alt="AddRequest state machine" width="100%"/>
<p>For a <strong>AddRequest</strong>, only one state is mandatory and must be followed by another state:</p>
<ul>
<li><em>ENTRY_STATE</em></li>
</ul>
<h2 id="addresponse-operation">AddResponse operation</h2>
<p>The <strong>Add</strong> operation response is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    AddResponse ::= [APPLICATION 9] LDAPResult
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-add-response.png" alt="AddResponse state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="bindrequest-operation">BindRequest operation</h2>
<p>The <strong>BindRequest</strong> message grammar is the following:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">        BindRequest ::= [APPLICATION 0] SEQUENCE {
             version                 INTEGER (1 ..  127),
             name                    OCTET STRING,
             authentication          AuthenticationChoice }

        AuthenticationChoice ::= CHOICE {
             simple                  [0] OCTET STRING,
             sasl                    [3] SaslCredentials,
             ...  }

        SaslCredentials ::= SEQUENCE {
             mechanism               OCTET STRING,
             credentials             OCTET STRING OPTIONAL }
</code></pre></div><p>Its state machine is shown in this picture:</p>
<img src="images/asn1-bind-request.png" alt="BindRequest state machine" width="100%"/>
<p>We have two flavors of <strong>Bind</strong>:</p>
<ul>
<li><strong>Simple</strong> bind, which uses a name and its credentials, in clear text</li>
<li><strong>SASL</strong> bind, which use a name, a mechanism and some added data. A dialog will be established, in which some responses and requests will be exchanged, until the authentication is established.</li>
</ul>
<p>For a <strong>BindRequest</strong>, only two states are mandatory and must be followed by another state:</p>
<ul>
<li><em>VERSION_STATE</em></li>
<li><em>NAME_STATE</em></li>
</ul>
<h2 id="bindresponse-operation">BindResponse operation</h2>
<p>The <strong>BindResponse</strong> message contains two elements:</p>
<ul>
<li>A <em>LdapResult</em> element</li>
<li>An optional response used in a aunthentication dialogue, if the <strong>BindRequest</strong> message was a <strong>SASL</strong> one</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">BindResponse ::= [APPLICATION 1] SEQUENCE {
             COMPONENTS OF LDAPResult,
             serverSaslCreds    [7] OCTET STRING OPTIONAL }
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-bind-response.png" alt="BindResponse state machine" width="100%"/>
<p>Just because we may have some data after the <strong>LDAPResult</strong> element, we use a special version of the <strong>LDAPResult</strong> state machine:</p>
<img src="images/asn1-ldap-result-BR.png" alt="BindResponse LDAPResult state machine" width="100%"/>
<p>In any case, two states are mandatory:</p>
<ul>
<li><em>RESULT_CODE_BR_STATE</em></li>
<li><em>MATCHED_DN_BR_STATE</em></li>
</ul>
<h2 id="comparerequest-operation">CompareRequest operation</h2>
<p>The <strong>CompareRequest</strong> message grammar is the following:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">CompareRequest ::= [APPLICATION 14] SEQUENCE {
             entry           OCTET STRING,
             ava             AttributeValueAssertion }

AttributeValueAssertion ::= SEQUENCE {
             attributeDesc   OCTET STRING,
             assertionValue  OCTET STRING }
</code></pre></div><p>Its state machine is shown in this picture:</p>
<img src="images/asn1-compare-request.png" alt="CompareRequest state machine" width="100%"/>
<p>For a <strong>CompareRequest</strong>, only one state is mandatory and must be followed by another state:</p>
<ul>
<li><em>AVA_COMP_STATE</em></li>
</ul>
<h2 id="compareresponse-operation">CompareResponse operation</h2>
<p>The <strong>CompareResponse</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    CompareResponse ::= [APPLICATION 15] LDAPResult
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-compare-response.png" alt="CompareResponse state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="delrequest-operation">DelRequest operation</h2>
<p>The <strong>DelRequest</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    DelRequest ::= [APPLICATION 10] OCTET STRING
</code></pre></div><p>The state machine for this operation is already described in the <a href="#ldapmessage">LdapMessage</a> state machine. The operation code (0x4A) is completed with the Object&rsquo;s DN to be removed.</p>
<h2 id="delresponse-operation">DelResponse operation</h2>
<p>The <strong>DelResponse</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    DelResponse ::= [APPLICATION 11] LDAPResult
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-del-response.png" alt="DelResponse state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="extendedrequest-operation">ExtendedRequest operation</h2>
<p>The <strong>ExtendedRequest</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">          ExtendedRequest ::= [APPLICATION 23] SEQUENCE {
             requestName      [0] OCTET STRING,
             requestValue     [1] OCTET STRING OPTIONAL }
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-extended-request.png" alt="ExtendedRequest state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="extendedresponse-operation">ExtendedResponse operation</h2>
<p>The <strong>ExtendedResponse</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    ExtendedResponse ::= [APPLICATION 24] SEQUENCE {
             COMPONENTS OF LDAPResult,
             responseName     [10] OCTET STRING OPTIONAL,
             responseValue    [11] OCTET STRING OPTIONAL }
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-extended-response.png" alt="ExtendedResponse state machine" width="100%"/>
<p>There are no mandatory state.</p>
<p>Just because we may have some data after the <strong>LDAPResult</strong> element, we use a special version of the <strong>LDAPResult</strong> state machine:</p>
<img src="images/asn1-ldap-result-ER.png" alt="ExtendedResponse LDAPResult state machine" width="100%"/>
<p>In any case, two states are mandatory:</p>
<ul>
<li><em>RESULT_CODE_ER_STATE</em></li>
<li><em>MATCHED_DN_ER_STATE</em></li>
</ul>
<h2 id="intermediateresponse-operation">IntermediateResponse operation</h2>
<p>The <strong>IntermediateResponse</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">        IntermediateResponse ::= [APPLICATION 25] SEQUENCE {
             responseName     [0] LDAPOID OPTIONAL,
             responseValue    [1] OCTET STRING OPTIONAL }
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-intermediate-response.png" alt="IntermediateResponse state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="modifyrequest-operation">ModifyRequest operation</h2>
<p>The <strong>ModifyRequest</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">ModifyRequest ::= [APPLICATION 6] SEQUENCE {
             object          OCTET STRING,
             changes         SEQUENCE OF change SEQUENCE {
                  operation       ENUMERATED {
                       add       (0),
                       delete    (1),
                       replace   (2),
                       increment (3),
                       ...  },
                  modification    PartialAttribute } }
</code></pre></div><p>With this common element, <strong>PartialAttribute</strong>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">PartialAttribute ::= SEQUENCE {
             type       OCTET STRING,
             vals       SET OF value OCTET STRING }
</code></pre></div><p>(Note: the <strong>PartialAttribute</strong> sub-element is shared with the <a href="#addrequest-message"><strong>AddRequest</strong></a> and <a href="#search-result-entry"><strong>SearchResultEntry</strong></a> messages)</p>
<p>The associated state machine is shown below:</p>
<img src="images/asn1-modify-request.png" alt="ModifyRequest state machine" width="100%"/>
<p>Two states are mandatory:</p>
<ul>
<li><em>CHANGES_STATE</em></li>
<li><em>MODIFICATION_STATE</em></li>
</ul>
<h2 id="modifyresponse-operation">ModifyResponse operation</h2>
<p>The <strong>ModifyResponse</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    ModifyResponse ::= [APPLICATION 7] LDAPResult
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-modify-response.png" alt="ModifyResponse state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="modifydnrequest-operation">ModifyDNRequest operation</h2>
<p>The <strong>ModifyDNRequest</strong> message grammar is the following:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">        ModifyDNRequest ::= [APPLICATION 12] SEQUENCE {
             entry           OCTET STRING,
             newrdn          OCTET STRING,
             deleteoldrdn    BOOLEAN,
             newSuperior     [0] OCTET STRING OPTIONAL }
</code></pre></div><p>Its state machine is shown in this picture:</p>
<img src="images/asn1-modify-dn-request.png" alt="ModifyRequest state machine" width="100%"/>
<p>For a <strong>ModifyRequest</strong>, one state is mandatory and must be followed by another state:</p>
<ul>
<li><em>ENTRY_MOD_DN_STATE</em></li>
</ul>
<h2 id="modifydnresponse--operation">ModifyDNResponse  operation</h2>
<p>The <strong>ModifyDNResponse</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    ModifyResponse ::= [APPLICATION 13] LDAPResult
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-modify-dn-response.png" alt="ModifyDNResponse state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="searchrequest">SearchRequest</h2>
<p>The <strong>SearchRequest</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">SearchRequest ::= [APPLICATION 3] SEQUENCE {
             baseObject      OCTET STRING,
             scope           ENUMERATED {
                  baseObject              (0),
                  singleLevel             (1),
                  wholeSubtree            (2),
                  ...  },
             derefAliases    ENUMERATED {
                  neverDerefAliases       (0),
                  derefInSearching        (1),
                  derefFindingBaseObj     (2),
                  derefAlways             (3) },
             sizeLimit       INTEGER (0 ..  maxInt),
             timeLimit       INTEGER (0 ..  maxInt),
             typesOnly       BOOLEAN,
             filter          Filter,
             attributes      AttributeSelection }

AttributeSelection ::= SEQUENCE OF selector OCTET STRING
</code></pre></div><p>It uses a set of elements (<em>Filter</em>, <em>SubstringFilter</em>, <em>MatchingRuleAssertion</em>, <em>AttributeValueAssertion</em>) that are described below.</p>
<p>The associated state machine is shown below:</p>
<img src="images/asn1-search-request.png" alt="SearchRequest state machine" width="100%"/>
<p>There are six mandatory states:</p>
<ul>
<li><em>BASE_OBJECT_STATE</em></li>
<li><em>SCOPE_STATE</em></li>
<li><em>DEREF_ALIAS_STATE</em></li>
<li><em>SIZE_LIMIT_STATE</em></li>
<li><em>TIME_LIMIT_STATE</em></li>
<li><em>TYPES_ONLY_STATE</em></li>
</ul>
<h3 id="filter">Filter</h3>
<p>The <strong>Filter</strong> grammar part is given below:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Filter ::= CHOICE {
             and             [0] SET SIZE (1..MAX) OF filter Filter,
             or              [1] SET SIZE (1..MAX) OF filter Filter,
             not             [2] Filter,
             equalityMatch   [3] AttributeValueAssertion,
             substrings      [4] SubstringFilter,
             greaterOrEqual  [5] AttributeValueAssertion,
             lessOrEqual     [6] AttributeValueAssertion,
             present         [7] OCTET STRING,
             approxMatch     [8] AttributeValueAssertion,
             extensibleMatch [9] MatchingRuleAssertion,
             ...  }

AttributeValueAssertion ::= SEQUENCE {
             attributeDesc   OCTET STRING,
             assertionValue  OCTET STRING }
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-filter.png" alt="Filter state machine" width="100%"/>
<p>There are six mandatory states:</p>
<ul>
<li><em>APPROX_MATCH_STATE</em></li>
<li><em>EQUALITY_MATCH_STATE</em></li>
<li><em>EXTENSIBLE_MATCH_STATE</em></li>
<li><em>GREATER_OR_EQUAL_STATE</em></li>
<li><em>LESS_OR_EQUAL_STATE</em></li>
<li><em>SUBSTRINGS_FILTER_STATE</em></li>
</ul>
<h3 id="matchingruleassertion">MatchingRuleAssertion</h3>
<p>The <strong>MatchingRuleAssertion</strong> grammar part is given below:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">MatchingRuleAssertion ::= SEQUENCE {
             matchingRule    [1] OCTET STRING OPTIONAL,
             type            [2] OCTET STRING OPTIONAL,
             matchValue      [3] OCTET STRING,
             dnAttributes    [4] BOOLEAN DEFAULT FALSE }
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-matching-rule-assertion.png" alt="Filter Matching Rule Assertion state machine" width="100%"/>
<p>There are two mandatory states:</p>
<ul>
<li><em>MRA_MATCHING_RULE_STATE</em></li>
<li><em>MRA_TYPE_STATE</em></li>
</ul>
<h3 id="substringfilter">SubstringFilter</h3>
<p>The <strong>SubstringFilter</strong> grammar part is given below:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">SubstringFilter ::= SEQUENCE {
             type           OCTET STRING,
             substrings     SEQUENCE SIZE (1..MAX) OF substring CHOICE {
                  initial [0] OCTET STRING,
                  any     [1] OCTET STRING,
                  final   [2] OCTET STRING }
             }
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-substrings-filter.png" alt="Substrings Filter state machine" width="100%"/>
<p>There is no mandatory transition</p>
<h2 id="searchresultdone">SearchResultDone</h2>
<p>The <strong>SearchResultDone</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    SearchResultDone ::= [APPLICATION 5] LDAPResult
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-search-result-done.png" alt="SearchResultDone state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="searchresultentry">SearchResultEntry</h2>
<p>The <strong>SearchResultEntry</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    SearchResultEntry ::= [APPLICATION 4] SEQUENCE {
             objectName      OCTET STRING,
             attributes      PartialAttributeList }

        PartialAttributeList ::= SEQUENCE OF
                             partialAttribute PartialAttribute

        PartialAttribute ::= SEQUENCE {
             type       OCTET STRING,
             vals       SET OF value OCTET STRING }
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-search-result-entry.png" alt="SearchResultEntry state machine" width="100%"/>
<p>There are two mandatory transitions:</p>
<ul>
<li><em>OBJECT_NAME_STATE</em></li>
<li><em>PARTIAL_ATTRIBUTE_LIST_STATE</em></li>
</ul>
<h2 id="searchresultreference">SearchResultReference</h2>
<p>The <strong>SearchResultReference</strong> message is described by this part of the <strong>LDAP</strong> grammar:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    SearchResultDone ::= [APPLICATION 5] LDAPResult
</code></pre></div><p>The associated state machine is shown below:</p>
<img src="images/asn1-search-result-reference.png" alt="SearchResultReference state machine" width="100%"/>
<p>There are no mandatory state.</p>
<h2 id="unbindrequest-operation">UnbindRequest operation</h2>
<p>This is the simplest operation. Its <strong>PDU</strong> contains only 2 bytes: <strong>0x42 0x00</strong>.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">        UnbindRequest ::= [APPLICATION 2] NULL
</code></pre></div><p>Its state machine is already fully contained in the <strong>LDAPMEssage</strong> state machine, as it&rsquo;s encoded directly.</p>
<h1 id="state-transitions">State transitions</h1>
<h2 id="state-followers">State followers</h2>
<p>This list gives all the possible tags for each of the state machine elements:</p>
<ul>
<li><em>ABANDON_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>ADD_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>ADD_RESPONSE_STATE</em>:  {Controls tag (0xA0), #}</li>
<li><em>AND_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>ANY_STATE</em>:
<ul>
<li>any tag (0x81)</li>
<li>final tag (0x82)}</li>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>APPROX_MATCH_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>ASSERTION_VALUE_FILTER_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>ASSERTION_VALUE_COMP_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>ATTRIBUTES_SR_STATE</em>: {PartialAttributeList tag (0x30)}</li>
<li><em>ATTRIBUTES_STATE</em>: {AttributeList tag (0x30)}</li>
<li><em>ATTRIBUTE_SELECTION_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>ATTRIBUTE_DESC_COMP_STATE</em>: {AssertionValue tag (0x04)}</li>
<li><em>ATTRIBUTE_DESC_FILTER_STATE</em>: {AssertionValue tag (0x04)}</li>
<li><em>ATTRIBUTE_STATE</em>: {type tag (0x04)}</li>
<li><em>ATTRIBUTE_VALUE_STATE</em>: {change tags (0x30), vals tag (0x04), Controls tag (0xA0), #}</li>
<li><em>AVA_COMP_STATE</em>: {AttributeDesc tag (0x04)}</li>
<li><em>BASE_OBJECT_STATE</em>: {scope tag (0x0A)}</li>
<li><em>BIND_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>BIND_RESPONSE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>CHANGES_STATE</em>: {change tag (0x30)}</li>
<li><em>CHANGE_STATE</em>: {operation tag (0x30)}</li>
<li><em>COMPARE_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>COMPARE_RESPONSE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>CONTROLS_STATE</em>: {Control tag (0x30)}</li>
<li><em>CONTROL_STATE</em>: {controlType tag (0x04)}</li>
<li><em>CONTROL_TYPE_STATE</em>: {criticality tag (0x01), controlValue tag (0x04), Control tag (0x30), #}</li>
<li><em>CONTROL_VALUE_STATE</em>: {Control tag (0x30), #}</li>
<li><em>CREDENTIALS_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>CRITICALITY_STATE</em>: {controlValue tag (0x04), Control tag (0x30), #}</li>
<li><em>DELETE_OLD_RDN_STATE</em>: {nowSuperior tag (0x80), Control tag (0x30), #}</li>
<li><em>DEL_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>DEL_RESPONSE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>DEREF_ALIAS_STATE</em>: {sizeLimit tag (0x02)}</li>
<li><em>DIAGNOSTIC_MESSAGE_BR_STATE</em>: {serverSaslCreds tag (0x87), Control tag (0x30), #}</li>
<li><em>DIAGNOSTIC_MESSAGE_ER_STATE</em>: {responseName tag (0x8A), responseValue tag (0x8B), Control tag (0x30), #}</li>
<li><em>DIAGNOSTIC_MESSAGE_STATE</em>: {Control tag (0x30), #}</li>
<li><em>ENTRY_COMP_STATE</em>: {ava tag (0x30)}</li>
<li><em>ENTRY_MOD_DN_STATE</em>: {newRdn tag (0x04)}</li>
<li><em>ENTRY_STATE</em>: {attributes tag (0x30)}</li>
<li><em>EQUALITY_MATCH_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>EXTENDED_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>EXTENDED_RESPONSE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>EXTENSIBLE_MATCH_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>FINAL_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>GREATER_OR_EQUAL_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>INITIAL_STATE</em>:
<ul>
<li>any tag (0x81)</li>
<li>final tag (0x82)</li>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>INTERMEDIATE_RESPONSE_NAME_STATE</em>: {responseValue tag (0x81), Controls tag (0xA0), #}</li>
<li><em>INTERMEDIATE_RESPONSE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>INTERMEDIATE_RESPONSE_VALUE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>LDAP_MESSAGE_STATE</em>: {messageId (0x02)}</li>
<li><em>LESS_OR_EQUAL_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>MATCHED_DN_BR_STATE</em>: {matchedDN tag (0x04)}</li>
<li><em>MATCHED_DN_ER_STATE</em>: {matchedDN tag (0x04)}</li>
<li><em>MATCHED_DN_STATE</em>: {matchedDN tag (0x04)}</li>
<li><em>MECHANISM_STATE</em>: {credentials tag (0x04), Controls tag (0xA0), #}</li>
<li><em>MESSAGE_ID_STATE</em>: protocolOp :
<ul>
<li>UnbindRequest tag (0x42)</li>
<li>DelRequest tag (0x4A)</li>
<li>AbandonRequest tag (0x50)</li>
<li>BindRequest tag (0x60)</li>
<li>BindResponse tag (0x61)</li>
<li>SearchRequest (0x63)</li>
<li>SearchResultEntry(0x64)</li>
<li>SearchResultDone(0x65)</li>
<li>ModifyRequest (0x66)</li>
<li>ModifyResponse (0x67)</li>
<li>AddRequest (0x68)</li>
<li>AddResponse (0x69)</li>
<li>DelResponse (0x6B)</li>
<li>ModifyDnRequest(0x6C)</li>
<li>ModifyDnResponse(0x6D)</li>
<li>CompareRequest (0x6E)</li>
<li>CompareResponse (0x6F)</li>
<li>SearchSearchResultReference (0x73)</li>
<li>ExtendedRequesrv (0x77)</li>
<li>ExtendedResponse (0x78)</li>
<li>IntermediateResponse (0x79)</li>
</ul>
</li>
<li><em>MODIFICATION_STATE</em>: {type tag (0x04)}</li>
<li><em>MODIFY_DN_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>MODIFY_DN_RESPONSE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>MODIFY_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>MODIFY_RESPONSE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>MRA_DN_ATTRIBUTES_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>MRA_MATCHING_RULE_STATE</em>: {type tag (0x82), matchValue tag (0x83)}</li>
<li><em>MRA_TYPE_STATE</em>: {matchValue tag (0x83)}</li>
<li><em>MRA_MATCH_VALUE_STATE</em>:
<ul>
<li>dnAttributes tag (0x84)</li>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>NAME_STATE</em>: {simple tag (0x80), sasl tag (0xA3)}</li>
<li><em>NEW_RDN_STATE</em>: {deleteOldrdn tag (0x01)}</li>
<li><em>NEW_SUPERIOR_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>NOT_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>OBJECT_NAME_STATE</em>: {attributes tag (0x30)}</li>
<li><em>OBJECT_STATE</em>: {changes tag (0x30)}</li>
<li><em>OPERATION_STATE</em>: {modification tag (0x30)}</li>
<li><em>OR_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>PARTIAL_ATTRIBUTES_LIST_STATE</em>: {type tag (0x04)}</li>
<li><em>PRESENT_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>REFERENCE_STATE</em>: {reference tag (0x04), Controls tag (0xA0), #}</li>
<li><em>REFERRAL_BR_STATE</em>: {uri tag (0x04), saslCredentials state (0x87), Controls tag (0xA0), #}</li>
<li><em>REFERRAL_ER_STATE</em>: {uri tag (0x04), responseName tag (0x8A), responseValue tag (0x8B), Controls tag (0xA0), #}</li>
<li><em>REFERRAL_STATE</em>: {uri tag (0x04), Controls tag (0xA0), #}</li>
<li><em>REQUEST_NAME_STATE</em>: {requestValue tag (0x81), Controls tag (0xA0), #}</li>
<li><em>REQUEST_VALUE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>RESPONSE_NAME_STATE</em>: {responseValue tag (0x8B), Controls tag (0xA0), #}</li>
<li><em>RESPONSE_VALUE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>RESULT_CODE_BR_STATE</em>: {matchedDn tag (0x04)}</li>
<li><em>RESULT_CODE_ER_STATE</em>: {matchedDn tag (0x04), responseName tag (0x8A), responseValue tag (0x8B), Controls tag (0xA0), #}</li>
<li><em>RESULT_CODE_STATE</em>: {matchedDn tag (0x04)}</li>
<li><em>SASL_STATE</em> {mechanism tag (0x04)}</li>
<li><em>SCOPE_STATE</em>: {derefAlias tag (0x0A)}</li>
<li><em>SEARCH_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>SEARCH_RESULT_DONE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>SEARCH_RESULT_ENTRY_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>SEARCH_RESULT_REFERENCE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>SELECTOR_STATE</em>: {selector tag (0x04), Controls tag (0xA0), #}</li>
<li><em>SERVER_SASL_CREDENTIALS_STATE</em>_: {Controls tag (0xA0), #}</li>
<li><em>SIMPLE_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>SIZE_LIMIT_STATE</em>: {timeLimit tag (0x02)}</li>
<li><em>START_STATE</em>: {LdapMessage tag 0x30}</li>
<li><em>SUBSTRINGS_STATE</em>: {initial tag (0x80), any tag (0x81), final tag (0x82)}</li>
<li><em>SUBSTRINGS_FILTER_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>AttributeSelection tag (0x30)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>TIME_LIMIT_STATE</em>: {typesOnly tag (0x01)}</li>
<li><em>TYPES_ONLY_STATE</em>:
<ul>
<li>present tag (0x87)</li>
<li>and tag (0xA0)</li>
<li>or tag (0xA1)</li>
<li>not tag (0xA2)</li>
<li>equality tag (0xA3)</li>
<li>substrings tag (0xA4)</li>
<li>equality match tag (0xA5)</li>
<li>less or equal tag (0xA6)</li>
<li>approxMatch tag (0xA8)</li>
<li>extensible match tag (0xA9)</li>
</ul>
</li>
<li><em>TYPE_MOD_STATE</em>: {vals tag (0x31)}</li>
<li><em>TYPE_SR_STATE</em>: {vals tag (0x31)}</li>
<li><em>TYPE_STATE</em>: {values tag (0x31)}</li>
<li><em>TYPE_SUBSTRING_STATE</em>: {substrings tag (0x30)}</li>
<li><em>UNBIND_REQUEST_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>URI_BR_STATE</em>: {serverSaslCreds tag (0x87), Controls tag (0xA0), #}</li>
<li><em>URI_ER_STATE</em>: {responseName tag (0x8A), responseValue tag (0x8B), Controls tag (0xA0), #}</li>
<li><em>URI_STATE</em>: {Controls tag (0xA0), #}</li>
<li><em>VALS_SR_STATE</em>: {partialAttribute tag (0x30), value tag (0x04), Controls tag (0xA0), #}</li>
<li><em>VALS_STATE</em>: {partialAttribute tag (0x30), value tag (0x04), Controls tag (0xA0), #}</li>
<li><em>VALUES_STATE</em>: {value tag (0x04)}</li>
<li><em>VALUE_STATE</em>: {attribute tag (0x30), value tag (0x04), Controls tag (0xA0), #}</li>
<li><em>VALUE_SR_STATE</em>: {value tag (0x04), Controls tag (0xA0), #}</li>
<li><em>VERSION_STATE</em>: {name tag (0x04)}</li>
</ul>


            
    <div class="nav">
        <div class="nav_prev">
            
                
                <a href="4.1-asn1-tlv.html">4-1 - ASN/1 TLV</a>
            
        </div>
        <div class="nav_up">
            
                
                <a href="../internal-design-guide.html">Internal Design Guide</a>
            
        </div>
        <div class="nav_next">
            
                
                <a href="5-network.html">5 - Network</a>
            
        </div>
        <div class="clearfix"></div>
    </div>


        </div>
        <div id="endContent"></div>
    </div>

    <div id="footer">
    &copy; 2003-2024, <a href="https://www.apache.org">The Apache Software Foundation</a> - <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a><br />
    Apache Directory, ApacheDS, Apache Directory Server, Apache Directory Studio, Apache LDAP API, Apache Triplesec,
    Triplesec, Apache Mavibot, Mavibot, Apache eSCIMo, eSCIMo, Apache SCIMple, SCIMple,Fortress, Apache Fortress, EnMasse,
    Apache EnMasse, Apache Kerby, Kerby, Apache, the Apache feather logo, and the Apache Directory project logos are
    trademarks of The Apache Software Foundation.
</div>

</div>

</body>

</html>
