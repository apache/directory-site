<!DOCTYPE html>

<html lang="en">
<script src="https://www.apachecon.com/event-images/snippet.js"></script>
<head>
    <meta charset="utf-8">
    <title>4.3. Password Policy &mdash; Apache Directory</title>

    <link href="/css/common.css" rel="stylesheet" type="text/css"/>
    <link href="/css/green.css" rel="stylesheet" type="text/css"/>

    <link rel="shortcut icon" href="/images/server-icon_16x16.png" />
</head>

<body>
<div id="container">
    <div id="header">
    <div id="subProjectsNavBar">
        <a href="/">
             
                Main
            
        </a>
        &nbsp;|&nbsp;
        <a href="/apacheds/">
            
                <strong>ApacheDS</strong>
            
        </a>
        &nbsp;|&nbsp;
        <a href="/studio/">
             
                Studio
            
        </a>
        &nbsp;|&nbsp;
        <a href="/api/">
             
                LDAP API
            
        </a>
        &nbsp;|&nbsp;
        <a href="/mavibot/">
             
                Mavibot
            
        </a>
        &nbsp;|&nbsp;
        <a href="/scimple/">
             
                SCIMple
            
        </a>
        &nbsp;|&nbsp;
        <a href="/fortress/">
             
                Fortress
            
        </a>
        &nbsp;|&nbsp;
        <a href="/kerby/">
             
                Kerby
            
        </a>
    </div>
</div>


    <div id="content">
        <div id="leftColumn">
            <div id="navigation">
                
                <a class="acevent" data-format="wide"></a>
                <h5>ApacheDS 2.0</h5>
                <ul>
                    <li><a href="/apacheds/">Home</a></li>
                    <li><a href="/apacheds/news.html">News</a></li>
                    <li><a href="/apacheds/features.html">Features</a></li>
                    <li><a href="/apacheds/production-readiness.html">Production Readiness</a></li>
                </ul>

                <h5>Downloads</h5>
                <ul>
                    <li><a href="/apacheds/downloads.html">ApacheDS 2.0.0.AM26</a>&nbsp;&nbsp;<img src="/images/new_badge.gif" alt="" style="margin-bottom:-3px;" border="0"></li>
                    <li><a href="/apacheds/download-old-versions.html">Older versions</a></li>
                </ul>

                <h5>Documentation</h5>
                <ul>
                    <li><a href="/apacheds/basic-user-guide.html">Basic User Guide </a></li>
                    <li><a href="/apacheds/advanced-user-guide.html">Advanced User Guide</a></li>
                    <li><a href="/apacheds/developer-guide.html">Developer Guide</a></li>
                    <li><a href="/apacheds/kerberos-user-guide.html">Kerberos User Guide</a></li>
                    <li><a href="/apacheds/configuration/ads-2.0-configuration.html">Configuration</a></li>
                    <li><a href="/apacheds/gen-docs/latest/apidocs">JavaDocs</a></li>
                    <li><a href="/apacheds/gen-docs/latest/xref">Cross-Reference</a></li>
                </ul>

                <h5>Support</h5>
<ul>
    <li><a href="/mailing-lists-and-irc.html">Mailing Lists &amp; IRC</a></li>
    <li><a href="/sources.html">Sources</a></li>
    <li><a href="/issue-tracking.html">Issue Tracking</a></li>
    <li><a href="/commercial-support.html">Commercial Support</a></li>
</ul>

<h5>Community</h5>
<ul>
    <li><a href="/contribute.html">How to Contribute</a></li>
    <li><a href="/team.html">Team</a></li>
    <li><a href="/original-project-proposal.html">Original Project Proposal</a></li>
    <li><a href="/special-thanks.html" class="external-link" rel="nofollow">Special Thanks</a></li>
</ul>

<h5>About Apache</h5>
<ul>
    <li><a href="https://www.apache.org/">Apache</a></li>
    <li><a href="https://www.apache.org/licenses/">License</a></li>
    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
    <li><a href="https://www.apache.org/security/">Security</a></li>
</ul>

            </div>
        </div>
        <div id="rightColumn">
            
    <div class="nav">
        <div class="nav_prev">
            
                
                <a href="4.2-authorization.html">4.2 - Authorization</a>
            
        </div>
        <div class="nav_up">
            
                
                <a href="4-authentication-and-authorization.html">4 - Authentication &amp; Authorization</a>
            
        </div>
        <div class="nav_next">
            
                
                <a href="5-administration.html">5 - Administration</a>
            
        </div>
        <div class="clearfix"></div>
    </div>


            
	<h1 id="43-password-policy">4.3. Password Policy</h1>
<p>The <strong>Password Policy for LDAP Directories</strong> is a <strong><a href="https://tools.ietf.org/html/draft-behera-ldap-password-policy-10">RFC</a></strong> draft that has been designed for the very first version in 1999, and the latest version is from 2009. Although it&rsquo;s still a draft, and it&rsquo;s currently noted as inactive, it has been implemented by many existing <strong>LDAP</strong> servers.</p>
<p><strong>ApacheDS</strong> implements most of the draft.</p>
<DIV class="warning" markdown="1">
Enforcing a strict password policy is extremely punitive to users. It may leads users to workaround the policy by storing their password in a post-it, a workaround that will defeat any password policy...
<p>Always try to think about better alternatives than force users to always define a password with 10 or more characters, including numbers, upper and lower case, special chars, and to change it every month&hellip;</p>
<p>A long sentence (4 or 5 words), like &ldquo;The horse has won the race three time&rdquo; is most certainly a better password than any other combination, and is easy to remember&hellip;</p>
</DIV>
<h2 id="what-is-a-password-policy-">What is a password policy ?</h2>
<p>As explained on <a href="https://en.wikipedia.org/wiki/Password_policy">wikipedia</a>:</p>
<pre><code>A password policy is a set of rules designed to enhance computer security by encouraging users to employ strong passwords 
and use them properly.
</code></pre>
<p>Basically, the system, once activated, will enforce some rules and check the password strength. We will list the various options in this chapter.</p>
<p>There are different aspects to consider:</p>
<ul>
<li>The password check when it&rsquo;s added or modified</li>
<li>The password management when the user bind, in other words, it&rsquo;s life cycle</li>
<li>The password protection against attacks</li>
</ul>
<p>Those aspects are exposed in the following paragraphs.</p>
<h2 id="how-do-we-configure-it-">How do we configure it ?</h2>
<p>The <em>Password Policy</em> can be configured in two ways.
First of all, it&rsquo;s important to know that it&rsquo;s activated by default. Let&rsquo;s see the default configuration first.</p>
<p>There is an entry containing all the default configuration values for the <em>Password Policy</em>, under the DN <strong>&ldquo;ou=passwordPolicies, ads-interceptorId=authenticationInterceptor, ou=interceptors, ads-directoryServiceId=&lt;default&gt;, ou=config&rdquo;</strong>, which corresponds to the following hierarchy:</p>
<pre><code>* ou=config
    * ads-directoryServiceId=&lt;default&gt;
        * ou=interceptors
            * ads-interceptorId=authenticationInterceptor
                * ou=passwordPolicies
</code></pre>
<p>This entry contains the following values:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Default value</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>ads-pwdAllowUserChange</td>
<td>TRUE</td>
<td>Tells if the user can change its password</td>
</tr>
<tr>
<td>ads-pwdCheckQuality</td>
<td>1</td>
<td>The kind of quality we want for the password (0, 1, or 2)</td>
</tr>
<tr>
<td>ads-pwdExpireWarning</td>
<td>600</td>
<td></td>
</tr>
<tr>
<td>ads-pwdFailureCountInterval</td>
<td>30</td>
<td>The duration of failure logs we keep in the entry</td>
</tr>
<tr>
<td>ads-pwdGraceAuthnLimit</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td>ads-pwdGraceExpire</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>ads-pwdInHistory</td>
<td>5</td>
<td>The number of passwords we keep in the password history</td>
</tr>
<tr>
<td>ads-pwdLockout</td>
<td>TRUE</td>
<td>Tells if the password should be locked or not on failures</td>
</tr>
<tr>
<td>ads-pwdLockoutDuration</td>
<td>0</td>
<td>The delay in seconds we wait before allowing a new attempt when the password hs been locked</td>
</tr>
<tr>
<td>ads-pwdMaxAge</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>ads-pwdMaxDelay</td>
<td>0</td>
<td>The maximum we wait before sending the BindResponse</td>
</tr>
<tr>
<td>ads-pwdMaxFailure</td>
<td>5</td>
<td>The maximum number of failure we accept before locking the password</td>
</tr>
<tr>
<td>ads-pwdMaxIdle</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>ads-pwdMaxLength</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>ads-pwdMinAge</td>
<td>0</td>
<td>The delay between two password changes</td>
</tr>
<tr>
<td>ads-pwdMinDelay</td>
<td>0</td>
<td>The minimum we wait before sending the BindResponse</td>
</tr>
<tr>
<td>ads-pwdMinLength</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td>ads-pwdMustChange</td>
<td>FALSE</td>
<td></td>
</tr>
<tr>
<td>ads-pwdSafeModify</td>
<td>FALSE</td>
<td></td>
</tr>
</tbody>
</table>
<p>Here is the entry in LDIF format:</p>
<pre><code>dn: ads-pwdId=default,ou=passwordPolicies,ads-interceptorId=authenticationIn
 terceptor,ou=interceptors,ads-directoryServiceId=default,ou=config
objectclass: top
objectclass: ads-base
objectclass: ads-passwordPolicy
ads-pwdAttribute: userPassword
ads-pwdId: default
ads-enabled: TRUE
ads-pwdAllowUserChange: TRUE
ads-pwdCheckQuality: 1
ads-pwdExpireWarning: 600
ads-pwdFailureCountInterval: 30
ads-pwdGraceAuthnLimit: 5
ads-pwdGraceExpire: 0
ads-pwdInHistory: 5
ads-pwdLockout: TRUE
ads-pwdLockoutDuration: 0
ads-pwdMaxAge: 0
ads-pwdMaxDelay: 0
ads-pwdMaxFailure: 5
ads-pwdMaxIdle: 0
ads-pwdMaxLength: 0
ads-pwdMinAge: 0
ads-pwdMinDelay: 0
ads-pwdMinLength: 5
ads-pwdMustChange: FALSE
ads-pwdSafeModify: FALSE
</code></pre>
<DIV class="warning" markdown="1">
All the configured delays are stored in seconds. As a rule of thumb, a day is 86400 seconds, a week is 604800 seconds and a month can be 2419200 seconds or 2505600 seconds (february normal and leap years), 2592000 seconds (april, june, september, november) and 2678400 (january, march, may, july, august, october and december)
</DIV>
<p>In the draft, it is said that the passwordPolicy can apply to one user or to many. It&rsquo;s also suggested that some <em>Administrative Area</em> could be used for that purpose : the users present in such an area will be constrained but the associated <em>PasswordPolicy</em>. At the moment, <strong>ApacheDS</strong> does not implement such a mechanism, and will rely on either the global configuration, stored in the <em>ou=config</em> partition, or we can define a specific <em>Password Policy</em> for a user. In this case, we will store in each user the reference to the <em>Password Policy</em> to use into the <em>pwdPolicySubentry</em> attribute (it contains a reference -a <strong>DN</strong> - to an entry storing the specific configuration).</p>
<p>This specific configuration is stored into an entry having the <em>pwdPolicy</em> Auxiliary ObjectClass, which description is :</p>
<pre><code>( 1.3.6.1.4.1.42.2.27.8.2.1
     NAME 'pwdPolicy'
     SUP top
     AUXILIARY
     MUST ( pwdAttribute )
     MAY ( pwdMinAge $ pwdMaxAge $ pwdInHistory $ pwdCheckQuality $
     pwdMinLength $ pwdMaxLength $ pwdExpireWarning $
     pwdGraceAuthNLimit $ pwdGraceExpiry $ pwdLockout $
     pwdLockoutDuration $ pwdMaxFailure $ pwdFailureCountInterval $
     pwdMustChange $ pwdAllowUserChange $ pwdSafeModify $
     pwdMinDelay $ pwdMaxDelay $ pwdMaxIdle ) )
</code></pre>
<DIV class="warning" markdown="1">
Note that the specification allows the administrator to apply the password policy on any attribute, with a default value of _userPassword_ ApacheDS does not yet allow the use of another Attribute.
</DIV>
<h4 id="enablingdisabling-the-passwordpolicy">Enabling/Disabling the PasswordPolicy</h4>
<p>The <em>PasswordPolicy</em> is enabled by default. It&rsquo;s possible to disable it by setting the <em>ads-enabled</em> value to FALSE, with a server restart.</p>
<h2 id="password-protection">Password protection</h2>
<p>This part is exposing the various techniques the system uses to protect your password from an attack.</p>
<h3 id="password-guessing-limit">Password guessing limit</h3>
<p>The idea is to protect the password against multiple guess attempts. The following rules are applied:</p>
<ul>
<li>a counter tracks the failed attempts, and blocks when it&rsquo;s reached</li>
<li>an incremental delay is added after a failure before a new attempt can be done</li>
<li>a global delay for all the failed attempt is used, when reached, the account is locked</li>
</ul>
<p>When the account is locked, it can remain locked, or be unlocked after a grace period.</p>
<h4 id="attempts-counter">Attempts counter</h4>
<DIV class="info" markdown="1">
Impacted Attributes: ads-pwdLockout, ads-pwdMaxFailure, ads-pwdLockoutDuration
</DIV>
<p>Each failed attempt will be logged in the entry, in the <em>ads-pwdFailureTime</em> Attribute (it will contain the date and time of the attempt). When the attribute contains more values than the maximum number of failed attempts, the entry will be locked (the <em>ads-pwdAccountLockedTime</em> Attribute will contain the date and time the entry has been locked).</p>
<DIV class="warning" markdown="1">
In order to activate this control the ads-pwdLockout parameter must be set to TRUE.
</DIV>
<p>The following table expose the various possible cases, with three failed attempts:</p>
<table>
<thead>
<tr>
<th><em>ads-pwdmaxfailure</em></th>
<th><em>ads-pwdLockout</em></th>
<th><em>ads-pwdFailureTime</em></th>
<th><em>ads-pwdAccountLockedTime</em></th>
<th>Locked</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>true</td>
<td>date1</td>
<td>-</td>
<td>No</td>
<td>Failure 1</td>
</tr>
<tr>
<td></td>
<td></td>
<td>date1, date2</td>
<td>-</td>
<td>No</td>
<td>Failure 2</td>
</tr>
<tr>
<td></td>
<td></td>
<td>date1, date2, date3</td>
<td>date3</td>
<td>Yes</td>
<td>Failure 3: account locked</td>
</tr>
<tr>
<td>3</td>
<td>false</td>
<td>date1</td>
<td>-</td>
<td>No</td>
<td>Failure 1</td>
</tr>
<tr>
<td></td>
<td></td>
<td>date1, date2</td>
<td>-</td>
<td>No</td>
<td>Failure 2</td>
</tr>
<tr>
<td></td>
<td></td>
<td>date1, date2, date3</td>
<td>-</td>
<td>No</td>
<td>Failure 3</td>
</tr>
</tbody>
</table>
<p>As we can see, the account is locked only when we reach the number of failure, and the <em>ads-pwdLockout</em> flag is TRUE. If the <em>ads-pwdLockoutDuration</em> flag is set, then the password will remain locked for the delay stored in this attribute.</p>
<h4 id="delayed-login">Delayed login</h4>
<DIV class="info" markdown="1">
Impacted Attributes: ads-pwdLockout, ads-pwdMaxFailure, ads-pwdLockoutDuration
</DIV>
<p>When we have reached a number of failed attempt, the account will be locked. We can set another attribute to tell the server that the locked out account can be unlocked after a delay: the <em>ads-pwdLockoutDuration</em> Attribute stores this delay.</p>
<p>When the account is locked, no further attempt will succeed, even if the correct password is sent. After the delay, the user will be unlocked.</p>
<h4 id="purging-failures">Purging failures</h4>
<DIV class="info" markdown="1">
Impacted Attributes: ads-pwdFailureCountInterval
</DIV>
<p>As we store all the failures within the entry, at some point we may want to purge those failures. This is done either because we have successfully logged, or because the <em>ads-pwdFailureCountInterval</em> value has expired. In this last case, all the failures older than the current time minus the set interval will be removed.</p>
<h3 id="password-checks-and-strength-enforcement">Password checks and strength enforcement</h3>
<p>Those rules are used to enforce some constraints on the password, so that weak passwords can&rsquo;t be used.</p>
<h4 id="quality-check-policy">Quality Check policy</h4>
<DIV class="info" markdown="1">
Impacted Attributes: ads-pwdQualityCheck<br>
Default value: 1
</DIV>
<p>The system can be enabled or disabled, and when enabled, two different level of checks can be done: relaxed or strict.
We use a parameter to specify the kind of check we do on the password: <em>ads-pwdCheckQuality</em>, which can take three values:</p>
<ul>
<li>0: The password is not checked</li>
<li>1: We check the password when we can, i.e. when it&rsquo;s not hashed. When the password is hashed, or in a form that does not allow us to apply the checks, then we ignore the errors</li>
<li>2: The password is checked, and if it&rsquo;s hashed or in a form that does not allow the checks to be done, then the changes are rejected.</li>
</ul>
<h4 id="password-history">Password History</h4>
<DIV class="info" markdown="1">
Impacted Attributes: ads-pwdInHistory
</DIV>
<p>The server can keep a backlog of passwords, so that a user can&rsquo;t keep a password for ever. When requested to do so the user will have to change his/her password, and the old password will be stored in the user&rsquo;s entry password history.</p>
<p>We can specify the number of passwords we keep in the password history by configuring the <em>ads-pwdInHistory</em> attribute.</p>
<h4 id="minimum-delay-between-modifications">Minimum delay between modifications</h4>
<DIV class="info" markdown="1">
Impacted Attributes: ads-pwdMinAge
</DIV>
<p>When the password history is activated, some users may change their passwords many times to get their old password out of the history, and add it as their password again.  Setting a delay between two password changes may protect the password against such action.</p>
<p>The <em>ads-pwdMinAge</em> attribute is used for this purpose, and it keeps a value in seconds.</p>
<h4 id="password-length-constraint">Password length constraint</h4>
<DIV class="info" markdown="1">
Impacted Attributes: ads-pwdMinLength and ads-pwdMaxLength
</DIV>
<p>You can control the minimum and maximum length for a password by setting the <em>ads-pwdMinLength</em> and <em>ads-pwdMaxLength</em> attributes.</p>
<DIV class="warning" markdown="1">
Setting a password max length is most certainly a waste of time. It's very likely that this parameter has been added to the specification for the sake of symetry...
</DIV>
<h3 id="password-lifecycle-management">Password lifecycle management</h3>
<p>We now have to expose the rules that apply to the password during it&rsquo;s life.</p>
<h4 id="password-max-age">Password max age</h4>
<DIV class="info" markdown="1">
Impacted Attribute: ads-pwdMaxAge
</DIV>
<p>A password may have a limited life expectation, and when this age is reached, the password will be invalidated. This is configured through the <em>ads-pwdMaxAge</em> parameter, which contains the number of second a password will last.</p>
<p>This password invalidation can be overruled by the two next parameters.</p>
<DIV class="warning" markdown="1">
This parameter works hands in hands with some other parameter, like the ads-pwdGraceAuthNLimit and ads-GraceExpire. If those parameters are set too, you may get some different delay for your password expiration.
</DIV>
<h4 id="password-grace-auth-n-limit">Password grace auth N limit</h4>
<DIV class="info" markdown="1">
Impacted Attribute: ads-pwdGraceAuthNLimit
</DIV>
<p>When the password has expired, this parameter (<em>ads-pwdGraceAuthNLimit</em>) tells how many times a user will still be allowed to bind before the password is definitively locked. Each attempt will decrement the associated counter.</p>
<h4 id="password-grace-expire">Password grace Expire</h4>
<DIV class="info" markdown="1">
Impacted Attribute: ads-pwdGraceExpire
</DIV>
<p>Another option when the password has expired is to give the user the possibility to log in during a certain period of time. This is mainly useful when the <em>ads-pwdGraceAuthNLimit</em> is set: not only there is a limited number of attempts, but those attempts must be done in a limited period of time, ortherwise the password will be locked.</p>
<p>If the configuration of the <em>ads-pwdGraceAuthNLimit</em> is 0, the <em>ads-pwdGraceExpire</em> value is simply added to the <em>ads-pwdMaxAge</em> value.</p>
<h4 id="idle-password">Idle Password</h4>
<DIV class="info" markdown="1">
Impacted Attribute: ads-pwdMaxIdle
</DIV>
<p>You can set a maximum inactivity delay for a password, before this password expires. This is set using the <em>ads-pwdMaxIdle</em> parameter</p>
<h4 id="expiration-warning">Expiration warning</h4>
<DIV class="info" markdown="1">
Impacted Attribute: ads-pwdExpireWarning
</DIV>
<p>The <em>ads-pwdExpireWarning</em> parameter will be used to send back a warning if the password if the password is going to expire in a given delay. This is convenient as soon as the client sends the <em>PasswordPolicy</em>  control to the server, and as soon as the client reads the response&rsquo;s control.</p>
<h4 id="allow-user-changes">Allow user changes</h4>
<DIV class="info" markdown="1">
Impacted Attribute: ads-pwdAllowUserChange
</DIV>
<p>The <em>ads-pwdAllowUserChange</em> parameter can be used to allow - or forbid - a user to change his/her own password. When this parameter is set to <em>TRUE</em>, the user can&rsquo;t change his/her password.</p>
<h3 id="not-supported-parameters">Not supported parameters</h3>
<p>A few parameters are described in the specification, but aren&rsquo;t supported. Here is the list :</p>
<ul>
<li>ads-pwdMinDelay : The minimal delay the server waits before sending back a response.</li>
<li>ads-pwdMaxDelay : The maximal delay the server waits before sending back a response.</li>
</ul>


            
    <div class="nav">
        <div class="nav_prev">
            
                
                <a href="4.2-authorization.html">4.2 - Authorization</a>
            
        </div>
        <div class="nav_up">
            
                
                <a href="4-authentication-and-authorization.html">4 - Authentication &amp; Authorization</a>
            
        </div>
        <div class="nav_next">
            
                
                <a href="5-administration.html">5 - Administration</a>
            
        </div>
        <div class="clearfix"></div>
    </div>


        </div>
        <div id="endContent"></div>
    </div>

    <div id="footer">
    &copy; 2003-2023, <a href="https://www.apache.org">The Apache Software Foundation</a> - <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a><br />
    Apache Directory, ApacheDS, Apache Directory Server, Apache Directory Studio, Apache LDAP API, Apache Triplesec,
    Triplesec, Apache Mavibot, Mavibot, Apache eSCIMo, eSCIMo, Apache SCIMple, SCIMple,Fortress, Apache Fortress, EnMasse,
    Apache EnMasse, Apache Kerby, Kerby, Apache, the Apache feather logo, and the Apache Directory project logos are
    trademarks of The Apache Software Foundation.
</div>

</div>

</body>

</html>
