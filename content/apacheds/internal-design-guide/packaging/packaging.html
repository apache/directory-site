<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Packaging &mdash; Apache Directory</title>

    <link href="/css/common.css" rel="stylesheet" type="text/css"/>
    <link href="/css/green.css" rel="stylesheet" type="text/css"/>

    <link rel="shortcut icon" href="/images/server-icon_16x16.png" />
    <script src="https://www.apachecon.com/event-images/snippet.js"></script>
</head>

<body>
<div id="container">
    <div id="header">
    <div id="subProjectsNavBar">
        <a href="/">
             
                Main
            
        </a>
        &nbsp;|&nbsp;
        <a href="/apacheds/">
            
                <strong>ApacheDS</strong>
            
        </a>
        &nbsp;|&nbsp;
        <a href="/studio/">
             
                Studio
            
        </a>
        &nbsp;|&nbsp;
        <a href="/api/">
             
                LDAP API
            
        </a>
        &nbsp;|&nbsp;
        <a href="/mavibot/">
             
                Mavibot
            
        </a>
        &nbsp;|&nbsp;
        <a href="/scimple/">
             
                SCIMple
            
        </a>
        &nbsp;|&nbsp;
        <a href="/fortress/">
             
                Fortress
            
        </a>
        &nbsp;|&nbsp;
        <a href="/kerby/">
             
                Kerby
            
        </a>
    </div>
</div>


    <div id="content">
        <div id="leftColumn">
            <div id="navigation">
                
                <a class="acevent" data-format="wide" data-width="170"></a>
                <h5>ApacheDS 2.0</h5>
                <ul>
                    <li><a href="/apacheds/">Home</a></li>
                    <li><a href="/apacheds/news.html">News</a></li>
                    <li><a href="/apacheds/features.html">Features</a></li>
                    <li><a href="/apacheds/production-readiness.html">Production Readiness</a></li>
                </ul>

                <h5>Downloads</h5>
                <ul>
                    <li><a href="/apacheds/downloads.html">ApacheDS 2.0.0.AM27</a>&nbsp;&nbsp;<img src="/images/new_badge.gif" alt="" style="margin-bottom:-3px;" border="0"></li>
                    <li><a href="/apacheds/download-old-versions.html">Older versions</a></li>
                </ul>

                <h5>Documentation</h5>
                <ul>
                    <li><a href="/apacheds/basic-user-guide.html">Basic User Guide </a></li>
                    <li><a href="/apacheds/advanced-user-guide.html">Advanced User Guide</a></li>
                    <li><a href="/apacheds/developer-guide.html">Developer Guide</a></li>
                    <li><a href="/apacheds/kerberos-user-guide.html">Kerberos User Guide</a></li>
                    <li><a href="/apacheds/configuration/ads-2.0-configuration.html">Configuration</a></li>
                    <li><a href="/apacheds/gen-docs/latest/apidocs">JavaDocs</a></li>
                    <li><a href="/apacheds/gen-docs/latest/xref">Cross-Reference</a></li>
                </ul>

                <h5>Support</h5>
<ul>
    <li><a href="/mailing-lists-and-irc.html">Mailing Lists &amp; IRC</a></li>
    <li><a href="/sources.html">Sources</a></li>
    <li><a href="/issue-tracking.html">Issue Tracking</a></li>
    <li><a href="/commercial-support.html">Commercial Support</a></li>
</ul>

<h5>Community</h5>
<ul>
    <li><a href="/contribute.html">How to Contribute</a></li>
    <li><a href="/team.html">Team</a></li>
    <li><a href="/original-project-proposal.html">Original Project Proposal</a></li>
    <li><a href="/special-thanks.html" class="external-link" rel="nofollow">Special Thanks</a></li>
</ul>

<h5>About Apache</h5>
<ul>
    <li><a href="https://www.apache.org/">Apache</a></li>
    <li><a href="https://www.apache.org/licenses/">License</a></li>
    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
    <li><a href="https://www.apache.org/security/">Security</a></li>
</ul>

            </div>
        </div>
        <div id="rightColumn">
            

            
	<h1 id="packaging">Packaging</h1>
<p><em>Apache Directory Server</em> is packaged in many flavvors:</p>
<ul>
<li>As a pure <em>linux</em> binary</li>
<li>As a <em>Debian</em> <em>dep</em> file</li>
<li>As a <em>RedHat</em> <em>RPM</em> file</li>
<li>As a <em>Mac OS</em> installer</li>
<li>As a <em>Winwosw</em> installer</li>
<li>As a <em>docker</em> installer</li>
<li>As a source archive</li>
</ul>
<p>We are going to explain how each of those packages are created.</p>
<h2 id="generalities">Generalities</h2>
<p>We use two sub-modules for the installer:</p>
<ul>
<li>The <em>apacheds-installers-maven-plugin</em> which is a <em>Maven</em> plugin used to create the various packages</li>
<li>The <em>apacheds-installers</em> which is creatinhg the packages</li>
</ul>
<p>The <em>apacheds-installers</em> project defines each of the target in its <em>pom.xml</em> file. For instance, for the <em>Debian</em> installer, we will use this configuration:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">    <span style="color:#008000;font-weight:bold">&lt;profile</span><span style="color:#008000;font-weight:bold">&gt;</span>
      <span style="color:#008000;font-weight:bold">&lt;id</span><span style="color:#008000;font-weight:bold">&gt;</span>debian<span style="color:#008000;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#008000;font-weight:bold">&lt;build</span><span style="color:#008000;font-weight:bold">&gt;</span>
        <span style="color:#008000;font-weight:bold">&lt;plugins</span><span style="color:#008000;font-weight:bold">&gt;</span>
          <span style="color:#080;font-style:italic">&lt;!--</span><span style="color:#080;font-style:italic"> Generating installers </span><span style="color:#080;font-style:italic">--&gt;</span>
          <span style="color:#008000;font-weight:bold">&lt;plugin</span><span style="color:#008000;font-weight:bold">&gt;</span>
            <span style="color:#008000;font-weight:bold">&lt;groupId</span><span style="color:#008000;font-weight:bold">&gt;</span>${project.groupId}<span style="color:#008000;font-weight:bold">&lt;/groupId&gt;</span>
            <span style="color:#008000;font-weight:bold">&lt;artifactId</span><span style="color:#008000;font-weight:bold">&gt;</span>apacheds-installers-maven-plugin<span style="color:#008000;font-weight:bold">&lt;/artifactId&gt;</span>
            <span style="color:#008000;font-weight:bold">&lt;configuration</span><span style="color:#008000;font-weight:bold">&gt;</span>
              <span style="color:#080;font-style:italic">&lt;!--</span><span style="color:#080;font-style:italic"> Targets for Linux .deb installer package </span><span style="color:#080;font-style:italic">--&gt;</span>
              <span style="color:#008000;font-weight:bold">&lt;debTargets</span><span style="color:#008000;font-weight:bold">&gt;</span>
                <span style="color:#008000;font-weight:bold">&lt;debTarget</span><span style="color:#008000;font-weight:bold">&gt;</span>
                  <span style="color:#008000;font-weight:bold">&lt;id</span><span style="color:#008000;font-weight:bold">&gt;</span>apacheds-debian-i386<span style="color:#008000;font-weight:bold">&lt;/id&gt;</span>
                  <span style="color:#008000;font-weight:bold">&lt;finalName</span><span style="color:#008000;font-weight:bold">&gt;</span>apacheds-${project.version}-i386.deb<span style="color:#008000;font-weight:bold">&lt;/finalName&gt;</span>
                  <span style="color:#008000;font-weight:bold">&lt;osArch</span><span style="color:#008000;font-weight:bold">&gt;</span>i386<span style="color:#008000;font-weight:bold">&lt;/osArch&gt;</span>
                <span style="color:#008000;font-weight:bold">&lt;/debTarget&gt;</span>
                
                <span style="color:#008000;font-weight:bold">&lt;debTarget</span><span style="color:#008000;font-weight:bold">&gt;</span>
                 <span style="color:#008000;font-weight:bold">&lt;id</span><span style="color:#008000;font-weight:bold">&gt;</span>apacheds-debian-amd64<span style="color:#008000;font-weight:bold">&lt;/id&gt;</span>
                  <span style="color:#008000;font-weight:bold">&lt;finalName</span><span style="color:#008000;font-weight:bold">&gt;</span>apacheds-${project.version}-amd64.deb<span style="color:#008000;font-weight:bold">&lt;/finalName&gt;</span>
                  <span style="color:#008000;font-weight:bold">&lt;osArch</span><span style="color:#008000;font-weight:bold">&gt;</span>amd64<span style="color:#008000;font-weight:bold">&lt;/osArch&gt;</span>
                <span style="color:#008000;font-weight:bold">&lt;/debTarget&gt;</span>
              <span style="color:#008000;font-weight:bold">&lt;/debTargets&gt;</span>
            <span style="color:#008000;font-weight:bold">&lt;/configuration&gt;</span>

            <span style="color:#008000;font-weight:bold">&lt;executions</span><span style="color:#008000;font-weight:bold">&gt;</span>
              <span style="color:#008000;font-weight:bold">&lt;execution</span><span style="color:#008000;font-weight:bold">&gt;</span>
                <span style="color:#008000;font-weight:bold">&lt;goals</span><span style="color:#008000;font-weight:bold">&gt;</span>
                  <span style="color:#008000;font-weight:bold">&lt;goal</span><span style="color:#008000;font-weight:bold">&gt;</span>generate<span style="color:#008000;font-weight:bold">&lt;/goal&gt;</span>
                <span style="color:#008000;font-weight:bold">&lt;/goals&gt;</span>
              <span style="color:#008000;font-weight:bold">&lt;/execution&gt;</span>
            <span style="color:#008000;font-weight:bold">&lt;/executions&gt;</span>
          <span style="color:#008000;font-weight:bold">&lt;/plugin&gt;</span>
        <span style="color:#008000;font-weight:bold">&lt;/plugins&gt;</span>
        
        <span style="color:#008000;font-weight:bold">&lt;pluginManagement</span><span style="color:#008000;font-weight:bold">&gt;</span>
          <span style="color:#008000;font-weight:bold">&lt;plugins</span><span style="color:#008000;font-weight:bold">&gt;</span>
            <span style="color:#008000;font-weight:bold">&lt;plugin</span><span style="color:#008000;font-weight:bold">&gt;</span>
              <span style="color:#008000;font-weight:bold">&lt;groupId</span><span style="color:#008000;font-weight:bold">&gt;</span>${project.groupId}<span style="color:#008000;font-weight:bold">&lt;/groupId&gt;</span>
              <span style="color:#008000;font-weight:bold">&lt;artifactId</span><span style="color:#008000;font-weight:bold">&gt;</span>apacheds-installers-maven-plugin<span style="color:#008000;font-weight:bold">&lt;/artifactId&gt;</span>
              <span style="color:#008000;font-weight:bold">&lt;version</span><span style="color:#008000;font-weight:bold">&gt;</span>${project.version}<span style="color:#008000;font-weight:bold">&lt;/version&gt;</span>
            <span style="color:#008000;font-weight:bold">&lt;/plugin&gt;</span>
          <span style="color:#008000;font-weight:bold">&lt;/plugins&gt;</span>
        <span style="color:#008000;font-weight:bold">&lt;/pluginManagement&gt;</span>
      <span style="color:#008000;font-weight:bold">&lt;/build&gt;</span>
    <span style="color:#008000;font-weight:bold">&lt;/profile&gt;</span>
</code></pre></div><p>We can see we have defined a specific profile for this package, <em>debian</em>, and that the <em>apacheds-installers-maven-plugin</em> plugin is configured to support two kinds of packages (<em>osArch</em> parameter):</p>
<ul>
<li>A <em>i386</em> package</li>
<li>An <em>amd64</em> packager</li>
</ul>
<p>We also set the <em>finalName</em> with the package name.</p>
<p>The <em>Maven</em> goal we call is named <em>generate</em>.</p>
<p>In Java, we will have one class per target, extending the parent <em>Target</em> class.</p>
<p>The <em>Target</em> parent class stores the target <em>id</em>, <em>architecture</em>, <em>OS</em> and the final file name. Each inheriting class stores the path to the tool to use to generate the installer:</p>
<ul>
<li><em>dpkg</em> for the <em>Debian</em> installer (defaults to <em>/usr/bin/dpkg</em>)</li>
<li><em>rpmbuild</em> for the <em>RedHat</em> installer (defaults to <em>/usr/bin/rpmbuild</em>)</li>
<li>TODO: Mac, Windows</li>
</ul>
<p>We use a default value, hard coded in the extended class, but this value can be ovveriden by the <em>pom.xml</em> configuration, and overriden by the use of a <em>-D</em> flag on teh command line (which has the highest level of precedence).</p>
<p>Each extended class implements the <em>execute()</em> method which is responsible for calling an <em>InstallerCommand</em> class. These classes are teh one which create the packages.</p>
<h2 id="linux-debian">Linux Debian</h2>
<p>The debian configuration is managed by the <em>DebTarget.java</em> file, which sets one specific parameneter:</p>
<ul>
<li><em>OsName</em> set to <em>Linux</em></li>
</ul>
<p>The three other parameters are declared in the <em>pom.xml</em> file:</p>
<ul>
<li><em>id</em> set to <em>apacheds-debian-i386</em> or apacheds-debian-amd64*</li>
<li><em>OsArch</em> set to <em>i386</em> or <em>i386</em> (see upper).</li>
<li><em>finalName</em> is set to <em>apacheds-<version>-i386.deb</em> or <em>apacheds-<version>-amd64.deb</em></li>
</ul>
<p>(They do have default value, which get overriden by configuration).</p>
<p>A <em>DebInstallerCommand</em> instance is created and its <em>execute()</em> method is called.</p>


            

        </div>
        <div id="endContent"></div>
    </div>

    <div id="footer">
    &copy; 2003-2023, <a href="https://www.apache.org">The Apache Software Foundation</a> - <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a><br />
    Apache Directory, ApacheDS, Apache Directory Server, Apache Directory Studio, Apache LDAP API, Apache Triplesec,
    Triplesec, Apache Mavibot, Mavibot, Apache eSCIMo, eSCIMo, Apache SCIMple, SCIMple,Fortress, Apache Fortress, EnMasse,
    Apache EnMasse, Apache Kerby, Kerby, Apache, the Apache feather logo, and the Apache Directory project logos are
    trademarks of The Apache Software Foundation.
</div>

</div>

</body>

</html>
