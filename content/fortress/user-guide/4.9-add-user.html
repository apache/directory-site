<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>4.9 - Add User &mdash; Apache Directory</title>

    <link href="/css/common.css" rel="stylesheet" type="text/css"/>
    <link href="/css/turquoise.css" rel="stylesheet" type="text/css"/>

    <link rel="shortcut icon" href="/images/server-icon_16x16.png" />
</head>

<body>
<div id="container">
    <div id="header">
    <div id="subProjectsNavBar">
        <a href="/">
             
                Main
            
        </a>
        &nbsp;|&nbsp;
        <a href="/apacheds/">
             
                ApacheDS
            
        </a>
        &nbsp;|&nbsp;
        <a href="/studio/">
             
                Studio
            
        </a>
        &nbsp;|&nbsp;
        <a href="/api/">
             
                LDAP API
            
        </a>
        &nbsp;|&nbsp;
        <a href="/mavibot/">
             
                Mavibot
            
        </a>
        &nbsp;|&nbsp;
        <a href="/scimple/">
             
                SCIMple
            
        </a>
        &nbsp;|&nbsp;
        <a href="/fortress/">
            
                <strong>Fortress</strong>
            
        </a>
        &nbsp;|&nbsp;
        <a href="/kerby/">
             
                Kerby
            
        </a>
    </div>
</div>


    <div id="content">
        <div id="leftColumn">
            <div id="navigation">
                
                <h5>Fortress</h5>
                <ul>
                    <li><a href="/fortress/">Home</a></li>
                    <li><a href="/fortress/history.html">History</a></li>
                    <li><a href="/fortress/news.html">News</a></li>
                </ul>

                <h5>Downloads</h5>
                <ul>
                    <li><a href="/fortress/downloads.html">Fortress 2.0.8</a>&nbsp;&nbsp;<img src="/images/new_badge.gif" alt="" style="margin-bottom:-3px;" border="0"></li>
                    <li><a href="/fortress/download-old-versions.html">Older versions</a></li>
                </ul>

                

                <h5>Documentation</h5>
                <ul>
                    <li><a href="/fortress/overview.html">Overview</a></li>
                    <li><a href="/fortress/installation.html">Installation Guide</a></li>
                    <li><a href="/fortress/gen-docs/latest/apidocs/">JavaDocs</a></li>
                    <li><a href="/fortress/user-guide.html">Users Guide</a></li>
                    <li><a href="/fortress/user-guide-advanced.html">Advanced Users Guide</a></li>
                    <li><a href="/fortress/coding-standards.html">Coding Standards</a></li>
                    <li><a href="/fortress/testimonials.html">Testimonials</a></li>
                    <li><a href="/fortress/developer-guide.html">Developer Guide</a></li>
                    
                    
                </ul>

                <h5>Support</h5>
<ul>
    <li><a href="/mailing-lists-and-irc.html">Mailing Lists &amp; IRC</a></li>
    <li><a href="/sources.html">Sources</a></li>
    <li><a href="/issue-tracking.html">Issue Tracking</a></li>
    <li><a href="/commercial-support.html">Commercial Support</a></li>
</ul>

<h5>Community</h5>
<ul>
    <li><a href="/contribute.html">How to Contribute</a></li>
    <li><a href="/team.html">Team</a></li>
    <li><a href="/original-project-proposal.html">Original Project Proposal</a></li>
    <li><a href="/special-thanks.html" class="external-link" rel="nofollow">Special Thanks</a></li>
</ul>

<h5>About Apache</h5>
<ul>
    <li><a href="https://www.apache.org/">Apache</a></li>
    <li><a href="https://www.apache.org/licenses/">License</a></li>
    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
    <li><a href="https://www.apache.org/security/">Security</a></li>
</ul>

            </div>
        </div>
        <div id="rightColumn">
            
    <div class="nav">
        <div class="nav_prev">
            
                
                <a href="4.8-delete-role.html">4.8 - Delete Role</a>
            
        </div>
        <div class="nav_up">
            
                
                <a href="4-fortress-code-samples.html">4 - Fortress Code Samples</a>
            
        </div>
        <div class="nav_next">
            
                
                <a href="4.10-delete-user.html">4.10 - Delete User</a>
            
        </div>
        <div class="clearfix"></div>
    </div>


            
	<h1 id="49---add-user">4.9 - Add User</h1>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">User <span style="color:#00a000">addUser</span><span style="color:#666">(</span>User user<span style="color:#666">)</span> <span style="color:#a2f;font-weight:bold">throws</span> SecurityException
</code></pre></div><p>This command creates a new RBAC user. The command is valid only if the new user is not already a member of the USERS data set.
The USER data set is updated. The new user does not own any session at the time of its creation.</p>
<p>required parameters:</p>
<ul>
<li>User#userId - maps to INetOrgPerson uid</li>
<li>User#password - used when password authentication is required</li>
<li>User#ou - contains the name of an already existing User OU node</li>
</ul>
<p>optional parameters:</p>
<ul>
<li>User#pwPolicy - contains the name of an already existing OpenLDAP password policy node</li>
<li>User#cn - maps to INetOrgPerson common name attribute</li>
<li>User#sn - maps to INetOrgPerson surname attribute</li>
<li>User#description - maps to INetOrgPerson description attribute</li>
<li>User#title - maps to INetOrgPerson title attribute</li>
<li>User#employeeType - maps to INetOrgPerson employeeType attribute</li>
<li>User#phones * - multivalued attribute maps to organizationalPerson telephoneNumber attribute</li>
<li>User#mobiles * - multivalued attribute maps to INetOrgPerson mobile attribute</li>
<li>User#emails * - multivalued attribute maps to INetOrgPerson mail attribute</li>
<li>User#address * - multivalued attribute maps to organizationalPerson postalAddress, st, l, postalCode, postOfficeBox attributes</li>
<li>User#beginTime - HHMM - determines begin hour user may activate session</li>
<li>User#endTime - HHMM - determines end hour user may activate session.</li>
<li>User#beginDate - YYYYMMDD - determines date when user may sign on</li>
<li>User#endDate - YYYYMMDD - indicates latest date user may sign on</li>
<li>User#beginLockDate - YYYYMMDD - determines beginning of enforced inactive status</li>
<li>User#endLockDate - YYYYMMDD - determines end of enforced inactive status</li>
<li>User#dayMask - 1234567, 1 = Sunday, 2 = Monday, etc - specifies which day of user may sign on</li>
<li>User#timeout - number (in minutes) of session inactivity time allowed</li>
<li>User#props * - multivalued attribute contains property key and values are separated with a &lsquo;:'. e.g. mykey1:myvalue1</li>
</ul>
<p>Parameters:</p>
<ul>
<li>user - User entity must contain User#userId and User#ou (required) and optional User#description,User#roles and many others.</li>
</ul>
<p>Returns:</p>
<ul>
<li>Returns entity containing user data that was added.</li>
</ul>
<p>Throws:</p>
<ul>
<li>SecurityException - thrown in the event of data validation or system error.</li>
</ul>
<h2 id="adduser">addUser</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.SecurityException</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.AdminMgr</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.AdminMgrFactory</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.ReviewMgr</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.ReviewMgrFactory</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.model.User</span><span style="color:#666">;</span>

<span style="color:#a2f">@test</span>
<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#a2f;font-weight:bold">static</span> <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">testCreateUser</span><span style="color:#666">(</span>String userId<span style="color:#666">,</span> String password<span style="color:#666">,</span> String userOu<span style="color:#666">)</span>
<span style="color:#666">{</span>
    String szLocation <span style="color:#666">=</span> <span style="color:#b44">&#34;.testCreateUser&#34;</span><span style="color:#666">;</span>
    <span style="color:#a2f;font-weight:bold">try</span>
    <span style="color:#666">{</span>
        <span style="color:#080;font-style:italic">// Instantiate the AdminMgr implementation.  All AdminMgr APIs can throw a SecurityException in the event
</span><span style="color:#080;font-style:italic"></span>        <span style="color:#080;font-style:italic">// of rule violation or system error.
</span><span style="color:#080;font-style:italic"></span>        AdminMgr adminMgr <span style="color:#666">=</span> AdminMgrFactory<span style="color:#666">.</span><span style="color:#b44">createInstance</span><span style="color:#666">(</span><span style="color:#666">)</span><span style="color:#666">;</span>
        User inUser <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> User<span style="color:#666">(</span>userId<span style="color:#666">,</span> password<span style="color:#666">)</span><span style="color:#666">;</span>
        <span style="color:#080;font-style:italic">// ou is required attribute:
</span><span style="color:#080;font-style:italic"></span>        inUser<span style="color:#666">.</span><span style="color:#b44">setOu</span><span style="color:#666">(</span>userOu<span style="color:#666">)</span><span style="color:#666">;</span>
        <span style="color:#080;font-style:italic">// Now call the add API.  The API will return User entity with associated LDAP dn if creation was successful.
</span><span style="color:#080;font-style:italic"></span>        User outUser <span style="color:#666">=</span> adminMgr<span style="color:#666">.</span><span style="color:#b44">addUser</span><span style="color:#666">(</span>inUser<span style="color:#666">)</span><span style="color:#666">;</span>
        assertNotNull<span style="color:#666">(</span>outUser<span style="color:#666">)</span><span style="color:#666">;</span>

        <span style="color:#080;font-style:italic">// Instantiate the ReviewMgr implementation which is used to interrogate policy information.
</span><span style="color:#080;font-style:italic"></span>        ReviewMgr reviewMgr <span style="color:#666">=</span> ReviewMgrFactory<span style="color:#666">.</span><span style="color:#b44">createInstance</span><span style="color:#666">(</span><span style="color:#666">)</span><span style="color:#666">;</span>

        <span style="color:#080;font-style:italic">// now read the newly created User entity back:
</span><span style="color:#080;font-style:italic"></span>        User outUser2 <span style="color:#666">=</span> reviewMgr<span style="color:#666">.</span><span style="color:#b44">readUser</span><span style="color:#666">(</span>inUser<span style="color:#666">)</span><span style="color:#666">;</span>
        assertTrue<span style="color:#666">(</span>szLocation <span style="color:#666">+</span> <span style="color:#b44">&#34; failed read&#34;</span><span style="color:#666">,</span> inUser<span style="color:#666">.</span><span style="color:#b44">equals</span><span style="color:#666">(</span>outUser2<span style="color:#666">)</span><span style="color:#666">)</span><span style="color:#666">;</span>
        LOG<span style="color:#666">.</span><span style="color:#b44">info</span><span style="color:#666">(</span>szLocation <span style="color:#666">+</span> <span style="color:#b44">&#34; user [&#34;</span> <span style="color:#666">+</span> outUser2<span style="color:#666">.</span><span style="color:#b44">getUserId</span><span style="color:#666">(</span><span style="color:#666">)</span> <span style="color:#666">+</span> <span style="color:#b44">&#34;] success&#34;</span><span style="color:#666">)</span><span style="color:#666">;</span>
    <span style="color:#666">}</span>
    <span style="color:#a2f;font-weight:bold">catch</span> <span style="color:#666">(</span>SecurityException ex<span style="color:#666">)</span>
    <span style="color:#666">{</span>
        LOG<span style="color:#666">.</span><span style="color:#b44">error</span><span style="color:#666">(</span>szLocation <span style="color:#666">+</span> <span style="color:#b44">&#34; caught SecurityException rc=&#34;</span> <span style="color:#666">+</span> ex<span style="color:#666">.</span><span style="color:#b44">getErrorId</span><span style="color:#666">(</span><span style="color:#666">)</span> <span style="color:#666">+</span> <span style="color:#b44">&#34;, msg=&#34;</span> <span style="color:#666">+</span> ex<span style="color:#666">.</span><span style="color:#b44">getMessage</span><span style="color:#666">(</span><span style="color:#666">)</span><span style="color:#666">,</span> ex<span style="color:#666">)</span><span style="color:#666">;</span>
        fail<span style="color:#666">(</span>ex<span style="color:#666">.</span><span style="color:#b44">getMessage</span><span style="color:#666">(</span><span style="color:#666">)</span><span style="color:#666">)</span><span style="color:#666">;</span>
    <span style="color:#666">}</span>
<span style="color:#666">}</span>
</code></pre></div>

            
    <div class="nav">
        <div class="nav_prev">
            
                
                <a href="4.8-delete-role.html">4.8 - Delete Role</a>
            
        </div>
        <div class="nav_up">
            
                
                <a href="4-fortress-code-samples.html">4 - Fortress Code Samples</a>
            
        </div>
        <div class="nav_next">
            
                
                <a href="4.10-delete-user.html">4.10 - Delete User</a>
            
        </div>
        <div class="clearfix"></div>
    </div>


        </div>
        <div id="endContent"></div>
    </div>

    <div id="footer">
    &copy; 2003-2023, <a href="https://www.apache.org">The Apache Software Foundation</a> - <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a><br />
    Apache Directory, ApacheDS, Apache Directory Server, Apache Directory Studio, Apache LDAP API, Apache Triplesec,
    Triplesec, Apache Mavibot, Mavibot, Apache eSCIMo, eSCIMo, Apache SCIMple, SCIMple,Fortress, Apache Fortress, EnMasse,
    Apache EnMasse, Apache Kerby, Kerby, Apache, the Apache feather logo, and the Apache Directory project logos are
    trademarks of The Apache Software Foundation.
</div>

</div>

</body>

</html>
