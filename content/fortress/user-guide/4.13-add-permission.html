<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>4.13 - Add Permission &mdash; Apache Directory</title>

    <link href="/css/common.css" rel="stylesheet" type="text/css"/>
    <link href="/css/turquoise.css" rel="stylesheet" type="text/css"/>

    <link rel="shortcut icon" href="/images/server-icon_16x16.png" />
</head>

<body>
<div id="container">
    <div id="header">
    <div id="subProjectsNavBar">
        <a href="/">
             
                Main
            
        </a>
        &nbsp;|&nbsp;
        <a href="/apacheds/">
             
                ApacheDS
            
        </a>
        &nbsp;|&nbsp;
        <a href="/studio/">
             
                Studio
            
        </a>
        &nbsp;|&nbsp;
        <a href="/api/">
             
                LDAP API
            
        </a>
        &nbsp;|&nbsp;
        <a href="/mavibot/">
             
                Mavibot
            
        </a>
        &nbsp;|&nbsp;
        <a href="/scimple/">
             
                SCIMple
            
        </a>
        &nbsp;|&nbsp;
        <a href="/fortress/">
            
                <strong>Fortress</strong>
            
        </a>
        &nbsp;|&nbsp;
        <a href="/kerby/">
             
                Kerby
            
        </a>
    </div>
</div>


    <div id="content">
        <div id="leftColumn">
            <div id="navigation">
                
                <h5>Fortress</h5>
                <ul>
                    <li><a href="/fortress/">Home</a></li>
                    <li><a href="/fortress/history.html">History</a></li>
                    <li><a href="/fortress/news.html">News</a></li>
                </ul>

                <h5>Downloads</h5>
                <ul>
                    <li><a href="/fortress/downloads.html">Fortress 2.0.8</a>&nbsp;&nbsp;<img src="/images/new_badge.gif" alt="" style="margin-bottom:-3px;" border="0"></li>
                    <li><a href="/fortress/download-old-versions.html">Older versions</a></li>
                </ul>

                

                <h5>Documentation</h5>
                <ul>
                    <li><a href="/fortress/overview.html">Overview</a></li>
                    <li><a href="/fortress/installation.html">Installation Guide</a></li>
                    <li><a href="/fortress/gen-docs/latest/apidocs/">JavaDocs</a></li>
                    <li><a href="/fortress/user-guide.html">Users Guide</a></li>
                    <li><a href="/fortress/user-guide-advanced.html">Advanced Users Guide</a></li>
                    <li><a href="/fortress/coding-standards.html">Coding Standards</a></li>
                    <li><a href="/fortress/testimonials.html">Testimonials</a></li>
                    <li><a href="/fortress/developer-guide.html">Developer Guide</a></li>
                    
                    
                </ul>

                <h5>Support</h5>
<ul>
    <li><a href="/mailing-lists-and-irc.html">Mailing Lists &amp; IRC</a></li>
    <li><a href="/sources.html">Sources</a></li>
    <li><a href="/issue-tracking.html">Issue Tracking</a></li>
    <li><a href="/commercial-support.html">Commercial Support</a></li>
</ul>

<h5>Community</h5>
<ul>
    <li><a href="/contribute.html">How to Contribute</a></li>
    <li><a href="/team.html">Team</a></li>
    <li><a href="/original-project-proposal.html">Original Project Proposal</a></li>
    <li><a href="/special-thanks.html" class="external-link" rel="nofollow">Special Thanks</a></li>
</ul>

<h5>About Apache</h5>
<ul>
    <li><a href="https://www.apache.org/">Apache</a></li>
    <li><a href="https://www.apache.org/licenses/">License</a></li>
    <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
    <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
    <li><a href="https://www.apache.org/security/">Security</a></li>
</ul>

            </div>
        </div>
        <div id="rightColumn">
            
    <div class="nav">
        <div class="nav_prev">
            
                
                <a href="4.12-delete-permobj.html">4.12 - Delete Permission Object</a>
            
        </div>
        <div class="nav_up">
            
                
                <a href="4-fortress-code-samples.html">4 - Fortress Code Samples</a>
            
        </div>
        <div class="nav_next">
            
                
                <a href="4.14-delete-permission.html">4.14 - Delete Permission</a>
            
        </div>
        <div class="clearfix"></div>
    </div>


            
	<h1 id="413---add-permission">4.13 - Add Permission</h1>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Permission <span style="color:#00a000">addPermission</span><span style="color:#666">(</span>Permission perm<span style="color:#666">)</span> <span style="color:#a2f;font-weight:bold">throws</span> SecurityException
</code></pre></div><p>This method will add permission operation to an existing permission object.
The perm operation entity may have Role or User associations.
The target Permission must not exist prior to calling.
A Fortress Permission instance exists in a hierarchical, one-many relationship between its parent: (PermObj-&gt;Permission).</p>
<p>required parameters:</p>
<ul>
<li>Permission#objName - contains the name of existing object being targeted for the permission add</li>
<li>Permission#opName - contains the name of new permission operation being added</li>
</ul>
<p>optional parameters:</p>
<ul>
<li>Permission#roles * - multi occurring attribute contains RBAC Roles that permission operation is being granted to</li>
<li>Permission#users * - multi occurring attribute contains Users that permission operation is being granted to</li>
<li>Permission#props * - multi-occurring property key and values are separated with a &lsquo;:'. e.g. mykey1:myvalue1</li>
<li>Permission#type - any safe text</li>
</ul>
<p>Parameters:</p>
<ul>
<li>perm - must contain the object, org.apache.directory.fortress.core.model.Permission#objName, and operation, Permission#opName, that identifies target along with optional other attributes.</li>
</ul>
<p>Returns:</p>
<ul>
<li>copy of Permission entity</li>
</ul>
<p>Throws:</p>
<ul>
<li>SecurityException - thrown in the event of perm object data or system error.</li>
</ul>
<h2 id="addpermission">addPermission</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.AdminMgr</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.AdminMgrFactory</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.ReviewMgr</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.ReviewMgrFactory</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.model.Permission</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">org.apache.directory.fortress.core.SecurityException</span><span style="color:#666">;</span>

<span style="color:#a2f">@test</span>
<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#a2f;font-weight:bold">static</span> <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">testAddPermission</span><span style="color:#666">(</span>String objName<span style="color:#666">,</span> String operation<span style="color:#666">)</span>
<span style="color:#666">{</span>
    String szLocation <span style="color:#666">=</span> <span style="color:#b44">&#34;.testAddPermissions&#34;</span><span style="color:#666">;</span>
    <span style="color:#a2f;font-weight:bold">try</span>
    <span style="color:#666">{</span>
        AdminMgr adminMgr <span style="color:#666">=</span> AdminMgrFactory<span style="color:#666">.</span><span style="color:#b44">createInstance</span><span style="color:#666">(</span><span style="color:#666">)</span><span style="color:#666">;</span>
        <span style="color:#080;font-style:italic">// The Permission entity is associated with PermObj (name) entity and is uniquely identified by Operation name:
</span><span style="color:#080;font-style:italic"></span>        Permission inPerm <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> Permission<span style="color:#666">(</span>objName<span style="color:#666">,</span> operation<span style="color:#666">)</span><span style="color:#666">;</span>

        <span style="color:#080;font-style:italic">// The Permission entity will be a child node of specified PermObject entity.
</span><span style="color:#080;font-style:italic"></span>        adminMgr<span style="color:#666">.</span><span style="color:#b44">addPermission</span><span style="color:#666">(</span>inPerm<span style="color:#666">)</span><span style="color:#666">;</span>

        <span style="color:#080;font-style:italic">// Instantiate the ReviewMgr implementation which is used to interrogate policy information.
</span><span style="color:#080;font-style:italic"></span>        ReviewMgr reviewMgr <span style="color:#666">=</span> ReviewMgrFactory<span style="color:#666">.</span><span style="color:#b44">createInstance</span><span style="color:#666">(</span><span style="color:#666">)</span><span style="color:#666">;</span>

        <span style="color:#080;font-style:italic">// now read the newly created Permission entity back.
</span><span style="color:#080;font-style:italic"></span>        Permission outPerm <span style="color:#666">=</span> reviewMgr<span style="color:#666">.</span><span style="color:#b44">readPermission</span><span style="color:#666">(</span>inPerm<span style="color:#666">)</span><span style="color:#666">;</span>

        <span style="color:#080;font-style:italic">// Do some validations.
</span><span style="color:#080;font-style:italic"></span>        assertNotNull<span style="color:#666">(</span>outPerm<span style="color:#666">)</span><span style="color:#666">;</span>
        assertTrue<span style="color:#666">(</span>szLocation <span style="color:#666">+</span> <span style="color:#b44">&#34; failed permission check&#34;</span><span style="color:#666">,</span> outPerm<span style="color:#666">.</span><span style="color:#b44">equals</span><span style="color:#666">(</span>inPerm<span style="color:#666">)</span><span style="color:#666">)</span><span style="color:#666">;</span>
        LOG<span style="color:#666">.</span><span style="color:#b44">info</span><span style="color:#666">(</span>szLocation <span style="color:#666">+</span> <span style="color:#b44">&#34; permission object [&#34;</span> <span style="color:#666">+</span> outPerm<span style="color:#666">.</span><span style="color:#b44">getObjName</span><span style="color:#666">(</span><span style="color:#666">)</span> <span style="color:#666">+</span> <span style="color:#b44">&#34;] operation name [&#34;</span> <span style="color:#666">+</span> outPerm<span style="color:#666">.</span><span style="color:#b44">getOpName</span><span style="color:#666">(</span><span style="color:#666">)</span> <span style="color:#666">+</span> <span style="color:#b44">&#34;] success&#34;</span><span style="color:#666">)</span><span style="color:#666">;</span>
    <span style="color:#666">}</span>
    <span style="color:#a2f;font-weight:bold">catch</span> <span style="color:#666">(</span>SecurityException ex<span style="color:#666">)</span>
    <span style="color:#666">{</span>
        LOG<span style="color:#666">.</span><span style="color:#b44">error</span><span style="color:#666">(</span>szLocation <span style="color:#666">+</span> <span style="color:#b44">&#34; caught SecurityException rc=&#34;</span> <span style="color:#666">+</span> ex<span style="color:#666">.</span><span style="color:#b44">getErrorId</span><span style="color:#666">(</span><span style="color:#666">)</span> <span style="color:#666">+</span> <span style="color:#b44">&#34;, msg=&#34;</span> <span style="color:#666">+</span> ex<span style="color:#666">.</span><span style="color:#b44">getMessage</span><span style="color:#666">(</span><span style="color:#666">)</span><span style="color:#666">,</span> ex<span style="color:#666">)</span><span style="color:#666">;</span>
        fail<span style="color:#666">(</span>ex<span style="color:#666">.</span><span style="color:#b44">getMessage</span><span style="color:#666">(</span><span style="color:#666">)</span><span style="color:#666">)</span><span style="color:#666">;</span>
    <span style="color:#666">}</span>
<span style="color:#666">}</span>
</code></pre></div>

            
    <div class="nav">
        <div class="nav_prev">
            
                
                <a href="4.12-delete-permobj.html">4.12 - Delete Permission Object</a>
            
        </div>
        <div class="nav_up">
            
                
                <a href="4-fortress-code-samples.html">4 - Fortress Code Samples</a>
            
        </div>
        <div class="nav_next">
            
                
                <a href="4.14-delete-permission.html">4.14 - Delete Permission</a>
            
        </div>
        <div class="clearfix"></div>
    </div>


        </div>
        <div id="endContent"></div>
    </div>

    <div id="footer">
    &copy; 2003-2022, <a href="https://www.apache.org">The Apache Software Foundation</a> - <a href="/privacy-policy.html">Privacy Policy</a><br />
    Apache Directory, ApacheDS, Apache Directory Server, Apache Directory Studio, Apache LDAP API, Apache Triplesec,
    Triplesec, Apache Mavibot, Mavibot, Apache eSCIMo, eSCIMo, Apache SCIMple, SCIMple,Fortress, Apache Fortress, EnMasse,
    Apache EnMasse, Apache Kerby, Kerby, Apache, the Apache feather logo, and the Apache Directory project logos are
    trademarks of The Apache Software Foundation.
</div>

</div>

</body>

</html>
